<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>LambertConformalConic.as</title>
<link rel="stylesheet" type="text/css" href="../../../../../../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptComment">/*
 * ArcGIS for Google Maps Flash API
 *
 * License http://www.apache.org/licenses/LICENSE-2.0
 */</span>
 <span class="ActionScriptASDoc">/**
 * @author nianwei at gmail dot com
 */</span> 

<span class="ActionScriptpackage">package</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">google</span>.<span class="ActionScriptDefault_Text">maps</span>.<span class="ActionScriptDefault_Text">extras</span>.<span class="ActionScriptDefault_Text">arcgislink</span>
<span class="ActionScriptBracket/Brace">{</span>
  <span class="ActionScriptASDoc">/**
  * This class represents a Spatial Reference System based on &lt;a target  = wiki href  = &apos;http://en.wikipedia.org/wiki/Lambert_conformal_conic_projection&apos;&gt;Lambert Conformal Conic Projection&lt;/a&gt;. */</span>
  <span class="ActionScriptReserved">public</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">LambertConformalConic</span> <span class="ActionScriptReserved">extends</span> <span class="ActionScriptDefault_Text">SpatialReference</span>
  <span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">a_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">e_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">F_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">FE_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lamdaF_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">n_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">rF_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">FN_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
    
    <span class="ActionScriptASDoc">/**
 * Create a Lambert Conformal Conic Projection based Spatial Reference. The &lt;code&gt;params&lt;/code&gt; passed in construction should
 * include the following properties:&lt;code&gt;
 * &lt;br/&gt;-wkid: well-known id
 * &lt;br/&gt;-semi_major:  ellipsoidal semi-major axis in meter
 * &lt;br/&gt;-unit: meters per unit
 * &lt;br/&gt;-inverse_flattening: inverse of flattening of the ellipsoid where 1/f  =  a/(a - b)
 * &lt;br/&gt;-standard_parallel_1: phi1, latitude of the first standard parallel
 * &lt;br/&gt;-standard_parallel_2: phi2, latitude of the second standard parallel
 * &lt;br/&gt;-latitude_of_origin: phiF, latitude of the false origin
 * &lt;br/&gt;-central_meridian: lamdaF, longitude of the false origin  (with respect to the prime meridian)
 * &lt;br/&gt;-false_easting: FE, false easting, the Eastings value assigned to the natural origin
 * &lt;br/&gt;-false_northing: FN, false northing, the Northings value assigned to the natural origin
 * &lt;/code&gt;
 * &lt;br/&gt; e.g. North Carolina State Plane NAD83 Feet: &lt;br/&gt;
 * &lt;code&gt; var ncsp82  = new ArcGISLambertConformalConic({wkid:2264, semi_major: 6378137.0,inverse_flattening: 298.257222101,
 *   standard_parallel_1: 34.33333333333334, standard_parallel_2: 36.16666666666666,
 *   central_meridian: -79.0, latitude_of_origin: 33.75,&apos;false_easting&apos;: 2000000.002616666,
 *   &apos;false_northing&apos;: 0, unit: 0.3048006096012192 }); &lt;/code&gt;
 * @name ArcGISLambertConformalConic
 * @extends ArcGISSpatialReference
 * @constructor
 * @param {Object} params
 */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">LambertConformalConic</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">params</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">)</span>
    <span class="ActionScriptBracket/Brace">{</span>
     <span class="ActionScriptComment">//http://pubs.er.usgs.gov/djvu/PP/PP_1395.pdf
</span>     <span class="ActionScriptComment">// http://www.posc.org/Epicentre.2_2/DataModel/ExamplesofUsage/eu_cs34.html
</span>     <span class="ActionScriptComment">//for NCSP83: GLatLng(35.102363,-80.5666)&lt;  === &gt; GPoint(1531463.95, 495879.744);
</span>      <span class="ActionScriptDefault_Text">params</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">params</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptBracket/Brace">{}</span>;
      <span class="ActionScriptReserved">super</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">params</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">f_i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">inverse_flattening</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">phi1</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">standard_parallel_1</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">RAD_DEG</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">phi2</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">standard_parallel_2</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">RAD_DEG</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">phiF</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">latitude_of_origin</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">RAD_DEG</span>;
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">a_</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">semi_major</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">unit</span>;
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">lamdaF_</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">central_meridian</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">RAD_DEG</span>;
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">FE_</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">false_easting</span>;
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">FN_</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">false_northing</span>;
      
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">f</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 1.0 <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">f_i</span>; <span class="ActionScriptComment">//e: eccentricity of the ellipsoid where e^2  =  2f - f^2 
</span>      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">es</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 2 <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">f</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">f</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">f</span>;
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">e_</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">sqrt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">es</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m1</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">calc_m_</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">phi1</span>, <span class="ActionScriptDefault_Text">es</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m2</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">calc_m_</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">phi2</span>, <span class="ActionScriptDefault_Text">es</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tF</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">calc_t_</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">phiF</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">e_</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">t1</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">calc_t_</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">phi1</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">e_</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">t2</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">calc_t_</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">phi2</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">e_</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">n_</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">log</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">m1</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">m2</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">log</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t1</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">t2</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">F_</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m1</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">n_</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">pow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t1</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">n_</span><span class="ActionScriptBracket/Brace">))</span>;
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">rF_</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">calc_r_</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">a_</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">F_</span>, <span class="ActionScriptDefault_Text">tF</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">n_</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">calc_m_</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">phi</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>, <span class="ActionScriptDefault_Text">es</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sinphi</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">sin</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">phi</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">cos</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">phi</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">sqrt</span><span class="ActionScriptBracket/Brace">(</span>1 <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">es</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">sinphi</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">sinphi</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">calc_t_</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">phi</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>, <span class="ActionScriptDefault_Text">e</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">esinphi</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">e</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">sin</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">phi</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">tan</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">PI</span> <span class="ActionScriptOperator">/</span> 4 <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">phi</span> <span class="ActionScriptOperator">/</span> 2<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">pow</span><span class="ActionScriptBracket/Brace">((</span>1 <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">esinphi</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptBracket/Brace">(</span>1 <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">esinphi</span><span class="ActionScriptBracket/Brace">)</span>, <span class="ActionScriptDefault_Text">e</span> <span class="ActionScriptOperator">/</span> 2<span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">calc_r_</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">a</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>, <span class="ActionScriptDefault_Text">F</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>, <span class="ActionScriptDefault_Text">t</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>, <span class="ActionScriptDefault_Text">n</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">a</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">F</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">pow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t</span>, <span class="ActionScriptDefault_Text">n</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">calc_phi_</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t_i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>, <span class="ActionScriptDefault_Text">e</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>, <span class="ActionScriptDefault_Text">phi</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">esinphi</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">e</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">sin</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">phi</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">PI</span> <span class="ActionScriptOperator">/</span> 2 <span class="ActionScriptOperator">-</span> 2 <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">atan</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t_i</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">pow</span><span class="ActionScriptBracket/Brace">((</span>1 <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">esinphi</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptBracket/Brace">(</span>1 <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">esinphi</span><span class="ActionScriptBracket/Brace">)</span>, <span class="ActionScriptDefault_Text">e</span> <span class="ActionScriptOperator">/</span> 2<span class="ActionScriptBracket/Brace">))</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">solve_phi_</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t_i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>, <span class="ActionScriptDefault_Text">e</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>, <span class="ActionScriptDefault_Text">init</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptComment">// iteration
</span>      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">phi</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">init</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">newphi</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">calc_phi_</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t_i</span>, <span class="ActionScriptDefault_Text">e</span>, <span class="ActionScriptDefault_Text">phi</span><span class="ActionScriptBracket/Brace">)</span>;<span class="ActionScriptComment">//this.
</span>      <span class="ActionScriptReserved">while</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">abs</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">newphi</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">phi</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;</span> 0.000000001 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> 10<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span>;
        <span class="ActionScriptDefault_Text">phi</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">newphi</span>;
        <span class="ActionScriptDefault_Text">newphi</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">calc_phi_</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t_i</span>, <span class="ActionScriptDefault_Text">e</span>, <span class="ActionScriptDefault_Text">phi</span><span class="ActionScriptBracket/Brace">)</span>;<span class="ActionScriptComment">//this.
</span>      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">newphi</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">forward</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lnglat</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">phi</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lnglat</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">RAD_DEG</span>;<span class="ActionScriptComment">// (Math.PI / 180);
</span>      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lamda</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lnglat</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">RAD_DEG</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">t</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">calc_t_</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">phi</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">e_</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">calc_r_</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">a_</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">F_</span>, <span class="ActionScriptDefault_Text">t</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">n_</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">theta</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">n_</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lamda</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">lamdaF_</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">E</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">FE_</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">sin</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">theta</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">N</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">FN_</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">rF_</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">r</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">cos</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">theta</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">E</span>, <span class="ActionScriptDefault_Text">N</span><span class="ActionScriptBracket/Brace">]</span>;
    <span class="ActionScriptBracket/Brace">}</span> 
    <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">reverse</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">coords</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">E</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">coords</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">N</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">coords</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">theta_i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">atan</span><span class="ActionScriptBracket/Brace">((</span><span class="ActionScriptDefault_Text">E</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">FE_</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">rF_</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">N</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">FN_</span><span class="ActionScriptBracket/Brace">)))</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r_i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">n_</span> <span class="ActionScriptOperator">&gt;</span> 0 <span class="ActionScriptOperator">?</span> 1 <span class="ActionScriptOperator">:</span> <span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">sqrt</span><span class="ActionScriptBracket/Brace">((</span><span class="ActionScriptDefault_Text">E</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">FE_</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">E</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">FE_</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">rF_</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">N</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">FN_</span><span class="ActionScriptBracket/Brace">))</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">rF_</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">N</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">FN_</span><span class="ActionScriptBracket/Brace">)))</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">t_i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">pow</span><span class="ActionScriptBracket/Brace">((</span><span class="ActionScriptDefault_Text">r_i</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">a_</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">F_</span><span class="ActionScriptBracket/Brace">))</span>, 1 <span class="ActionScriptOperator">/</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">n_</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">phi</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">solve_phi_</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">t_i</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">e_</span>, 0<span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lamda</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">theta_i</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">n_</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">lamdaF_</span>;
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">lamda</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">RAD_DEG</span>, <span class="ActionScriptDefault_Text">phi</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">RAD_DEG</span><span class="ActionScriptBracket/Brace">]</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getCircumference</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">PI</span> <span class="ActionScriptOperator">*</span> 2 <span class="ActionScriptOperator">*</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">a_</span>;
    <span class="ActionScriptBracket/Brace">}</span>
  <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptBracket/Brace">}</span></pre></body>
</html>
