<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>SpatialReferences.as</title>
<link rel="stylesheet" type="text/css" href="../../../../../../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptComment">/*
 * ArcGIS for Google Maps Flash API
 *
 * License http://www.apache.org/licenses/LICENSE-2.0
 */</span>
 <span class="ActionScriptASDoc">/**
 * @author nianwei at gmail dot com
 */</span> 

<span class="ActionScriptpackage">package</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">google</span>.<span class="ActionScriptDefault_Text">maps</span>.<span class="ActionScriptDefault_Text">extras</span>.<span class="ActionScriptDefault_Text">arcgislink</span>
<span class="ActionScriptBracket/Brace">{</span>
  <span class="ActionScriptASDoc">/**
  * Collection of ArcGISSpatialReference
  */</span> 
  <span class="ActionScriptReserved">public</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">SpatialReferences</span>
  <span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">WGS84</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SpatialReference</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Geographic</span><span class="ActionScriptBracket/Brace">({</span><span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptOperator">:</span>4326<span class="ActionScriptBracket/Brace">})</span>;
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">NAD83</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SpatialReference</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Geographic</span><span class="ActionScriptBracket/Brace">({</span><span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptOperator">:</span>4269<span class="ActionScriptBracket/Brace">})</span>;
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">WEB_MERCATOR</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SpatialReference</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SphereMercator</span><span class="ActionScriptBracket/Brace">({</span>
      <span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptOperator">:</span> 102113,
      <span class="ActionScriptDefault_Text">semi_major</span><span class="ActionScriptOperator">:</span> 6378137.0,
      <span class="ActionScriptDefault_Text">central_meridian</span><span class="ActionScriptOperator">:</span> 0,
      <span class="ActionScriptDefault_Text">unit</span><span class="ActionScriptOperator">:</span> 1
    <span class="ActionScriptBracket/Brace">})</span>;
    
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_srs</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptString">&apos;4326&apos;</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">SpatialReferences</span>.<span class="ActionScriptDefault_Text">WGS84</span>,
      <span class="ActionScriptString">&apos;4269&apos;</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">SpatialReferences</span>.<span class="ActionScriptDefault_Text">NAD83</span>,
      <span class="ActionScriptString">&apos;102113&apos;</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">SpatialReferences</span>.<span class="ActionScriptDefault_Text">WEB_MERCATOR</span>
    <span class="ActionScriptBracket/Brace">}</span>;
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addSpatialReference</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>, <span class="ActionScriptDefault_Text">wktOrSR</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SpatialReference</span>
    <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sr</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SpatialReference</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_srs</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptString">&apos;&apos;</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">SpatialReference</span>;
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sr</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">sr</span>;
      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">wktOrSR</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">SpatialReference</span><span class="ActionScriptBracket/Brace">){</span>
        <span class="ActionScriptDefault_Text">_srs</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptString">&apos;&apos;</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">wktOrSR</span>;
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">wktOrSR</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">SpatialReference</span>;
      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">wkt</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">wktOrSR</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">String</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">params</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">wkid</span>
      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">prj</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ArcGISUtil</span>.<span class="ActionScriptDefault_Text">extractString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">wkt</span>, <span class="ActionScriptString">&quot;PROJECTION[\&quot;&quot;</span>, <span class="ActionScriptString">&quot;\&quot;]&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">spheroid</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ArcGISUtil</span>.<span class="ActionScriptDefault_Text">extractString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">wkt</span>, <span class="ActionScriptString">&quot;SPHEROID[&quot;</span>, <span class="ActionScriptString">&quot;]&quot;</span><span class="ActionScriptBracket/Brace">)</span>.<span class="ActionScriptDefault_Text">split</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;,&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">prj</span> <span class="ActionScriptOperator">!==</span> <span class="ActionScriptString">&quot;&quot;</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">unit</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parseFloat</span><span class="ActionScriptBracket/Brace">(A</span><span class="ActionScriptDefault_Text">rcGISUtil</span>.<span class="ActionScriptDefault_Text">extractString</span><span class="ActionScriptBracket/Brace">(A</span><span class="ActionScriptDefault_Text">rcGISUtil</span>.<span class="ActionScriptDefault_Text">extractString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">wkt</span>, <span class="ActionScriptString">&quot;PROJECTION&quot;</span>, <span class="ActionScriptString">&quot;&quot;</span><span class="ActionScriptBracket/Brace">)</span>, <span class="ActionScriptString">&quot;UNIT[&quot;</span>, <span class="ActionScriptString">&quot;]&quot;</span><span class="ActionScriptBracket/Brace">)</span>.<span class="ActionScriptDefault_Text">split</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;,&quot;</span><span class="ActionScriptBracket/Brace">)[</span>1<span class="ActionScriptBracket/Brace">])</span>;
        <span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">semi_major</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parseFloat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">spheroid</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">])</span>;
        <span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">inverse_flattening</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parseFloat</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">spheroid</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">])</span>;
        <span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">latitude_of_origin</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parseFloat</span><span class="ActionScriptBracket/Brace">(A</span><span class="ActionScriptDefault_Text">rcGISUtil</span>.<span class="ActionScriptDefault_Text">extractString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">wkt</span>, <span class="ActionScriptString">&quot;\&quot;Latitude_Of_Origin\&quot;,&quot;</span>, <span class="ActionScriptString">&quot;]&quot;</span><span class="ActionScriptBracket/Brace">))</span>;
        <span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">central_meridian</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parseFloat</span><span class="ActionScriptBracket/Brace">(A</span><span class="ActionScriptDefault_Text">rcGISUtil</span>.<span class="ActionScriptDefault_Text">extractString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">wkt</span>, <span class="ActionScriptString">&quot;\&quot;Central_Meridian\&quot;,&quot;</span>, <span class="ActionScriptString">&quot;]&quot;</span><span class="ActionScriptBracket/Brace">))</span>;
        <span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">false_easting</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parseFloat</span><span class="ActionScriptBracket/Brace">(A</span><span class="ActionScriptDefault_Text">rcGISUtil</span>.<span class="ActionScriptDefault_Text">extractString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">wkt</span>, <span class="ActionScriptString">&quot;\&quot;False_Easting\&quot;,&quot;</span>, <span class="ActionScriptString">&quot;]&quot;</span><span class="ActionScriptBracket/Brace">))</span>;
        <span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">false_northing</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parseFloat</span><span class="ActionScriptBracket/Brace">(A</span><span class="ActionScriptDefault_Text">rcGISUtil</span>.<span class="ActionScriptDefault_Text">extractString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">wkt</span>, <span class="ActionScriptString">&quot;\&quot;False_Northing\&quot;,&quot;</span>, <span class="ActionScriptString">&quot;]&quot;</span><span class="ActionScriptBracket/Brace">))</span>;
      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptReserved">switch</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">prj</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;&quot;</span><span class="ActionScriptOperator">:</span>
        <span class="ActionScriptDefault_Text">sr</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SpatialReference</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">params</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">break</span>;
      <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;Lambert_Conformal_Conic&quot;</span><span class="ActionScriptOperator">:</span>
        <span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">standard_parallel_1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parseFloat</span><span class="ActionScriptBracket/Brace">(A</span><span class="ActionScriptDefault_Text">rcGISUtil</span>.<span class="ActionScriptDefault_Text">extractString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">wkt</span>, <span class="ActionScriptString">&quot;\&quot;Standard_Parallel_1\&quot;,&quot;</span>, <span class="ActionScriptString">&quot;]&quot;</span><span class="ActionScriptBracket/Brace">))</span>;
        <span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">standard_parallel_2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parseFloat</span><span class="ActionScriptBracket/Brace">(A</span><span class="ActionScriptDefault_Text">rcGISUtil</span>.<span class="ActionScriptDefault_Text">extractString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">wkt</span>, <span class="ActionScriptString">&quot;\&quot;Standard_Parallel_2\&quot;,&quot;</span>, <span class="ActionScriptString">&quot;]&quot;</span><span class="ActionScriptBracket/Brace">))</span>;
        <span class="ActionScriptDefault_Text">sr</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">LambertConformalConic</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">params</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">break</span>;
      <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;Transverse_Mercator&quot;</span><span class="ActionScriptOperator">:</span>
        <span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">scale_factor</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">parseFloat</span><span class="ActionScriptBracket/Brace">(A</span><span class="ActionScriptDefault_Text">rcGISUtil</span>.<span class="ActionScriptDefault_Text">extractString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">wkt</span>, <span class="ActionScriptString">&quot;\&quot;Scale_Factor\&quot;,&quot;</span>, <span class="ActionScriptString">&quot;]&quot;</span><span class="ActionScriptBracket/Brace">))</span>;
        <span class="ActionScriptDefault_Text">sr</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">TransverseMercator</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">params</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">break</span>;
      <span class="ActionScriptComment">// more implementations here.
</span>      <span class="ActionScriptReserved">default</span><span class="ActionScriptOperator">:</span>
      <span class="ActionScriptComment">//throw new Error(prj + &quot;  not supported&quot;;
</span>      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sr</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">_srs</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptString">&apos;&apos;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sr</span>;
      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">sr</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getSpatialReference</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SpatialReference</span><span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">_srs</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptString">&apos;&apos;</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptBracket/Brace">]</span>;
    <span class="ActionScriptBracket/Brace">}</span>

  <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptBracket/Brace">}</span></pre></body>
</html>
