<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>ArcGISUtil.as</title>
<link rel="stylesheet" type="text/css" href="../../../../../../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptComment">/*
 * ArcGIS for Google Maps Flash API
 *
 * License http://www.apache.org/licenses/LICENSE-2.0
 */</span> <span class="ActionScriptASDoc">/**
 * @author nianwei at gmail dot com
 */</span>
<span class="ActionScriptpackage">package</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">google</span>.<span class="ActionScriptDefault_Text">maps</span>.<span class="ActionScriptDefault_Text">extras</span>.<span class="ActionScriptDefault_Text">arcgislink</span> <span class="ActionScriptBracket/Brace">{</span>

  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">google</span>.<span class="ActionScriptDefault_Text">maps</span>.<span class="ActionScriptDefault_Text">extras</span>.<span class="ActionScriptDefault_Text">arcgislink</span>.<span class="ActionScriptDefault_Text">json</span>.<span class="ActionScriptOperator">*</span>;

  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">google</span>.<span class="ActionScriptDefault_Text">maps</span>.<span class="ActionScriptOperator">*</span>;
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">google</span>.<span class="ActionScriptDefault_Text">maps</span>.<span class="ActionScriptDefault_Text">interfaces</span>.<span class="ActionScriptDefault_Text">IOverlay</span>;
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">google</span>.<span class="ActionScriptDefault_Text">maps</span>.<span class="ActionScriptDefault_Text">overlays</span>.<span class="ActionScriptOperator">*</span>;

  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">events</span>.<span class="ActionScriptOperator">*</span>;
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">Point</span>;
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">net</span>.<span class="ActionScriptOperator">*</span>;
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">utils</span>.<span class="ActionScriptOperator">*</span>;

  <span class="ActionScriptComment">// import mx.rpc.events.*;
</span>  <span class="ActionScriptComment">// import mx.rpc.http.*;
</span>
  <span class="ActionScriptASDoc">/**
   * Utility tools
   */</span>
  <span class="ActionScriptReserved">public</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">ArcGISUtil</span> <span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">ArcGISUtil</span><span class="ActionScriptBracket/Brace">()</span> <span class="ActionScriptBracket/Brace">{</span>

    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
     * Helper method to convert an {@link ArcGISEnvelope} object to &lt;code&gt;GLatLngBounds&lt;/code&gt;
     * @param {Envelope} extent
     * @return {GLatLngBounds} gLatLngBounds
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">fromEnvelopeToLatLngBounds</span><span class="ActionScriptBracket/Brace">(</span> <span class="ActionScriptComment">/*Envelope*/</span> <span class="ActionScriptDefault_Text">extent</span><span class="ActionScriptOperator">:*</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">LatLngBounds</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sr</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SpatialReference</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">SpatialReferences</span>.<span class="ActionScriptDefault_Text">getSpatialReference</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">extent</span>.<span class="ActionScriptDefault_Text">spatialReference</span>.<span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptDefault_Text">sr</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">sr</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">SpatialReferences</span>.<span class="ActionScriptDefault_Text">WGS84</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sw</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">sr</span>.<span class="ActionScriptDefault_Text">reverse</span><span class="ActionScriptBracket/Brace">([</span><span class="ActionScriptDefault_Text">extent</span>.<span class="ActionScriptDefault_Text">xmin</span>, <span class="ActionScriptDefault_Text">extent</span>.<span class="ActionScriptDefault_Text">ymin</span><span class="ActionScriptBracket/Brace">])</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ne</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">sr</span>.<span class="ActionScriptDefault_Text">reverse</span><span class="ActionScriptBracket/Brace">([</span><span class="ActionScriptDefault_Text">extent</span>.<span class="ActionScriptDefault_Text">xmax</span>, <span class="ActionScriptDefault_Text">extent</span>.<span class="ActionScriptDefault_Text">ymax</span><span class="ActionScriptBracket/Brace">])</span>;
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">LatLngBounds</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">LatLng</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sw</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">sw</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">])</span>, <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">LatLng</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ne</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">ne</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]))</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">internal</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">fromLatLngBoundsToEnvelope</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">gLatLngBounds</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">LatLngBounds</span>, <span class="ActionScriptDefault_Text">spatialReference</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SpatialReference</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:*</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptDefault_Text">spatialReference</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">spatialReference</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">SpatialReferences</span>.<span class="ActionScriptDefault_Text">WGS84</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sw</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">spatialReference</span>.<span class="ActionScriptDefault_Text">forward</span><span class="ActionScriptBracket/Brace">([</span><span class="ActionScriptDefault_Text">gLatLngBounds</span>.<span class="ActionScriptDefault_Text">getSouthWest</span><span class="ActionScriptBracket/Brace">()</span>.<span class="ActionScriptDefault_Text">lng</span><span class="ActionScriptBracket/Brace">()</span>, <span class="ActionScriptDefault_Text">gLatLngBounds</span>.<span class="ActionScriptDefault_Text">getSouthWest</span><span class="ActionScriptBracket/Brace">()</span>.<span class="ActionScriptDefault_Text">lat</span><span class="ActionScriptBracket/Brace">()])</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ne</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">spatialReference</span>.<span class="ActionScriptDefault_Text">forward</span><span class="ActionScriptBracket/Brace">([</span><span class="ActionScriptDefault_Text">gLatLngBounds</span>.<span class="ActionScriptDefault_Text">getNorthEast</span><span class="ActionScriptBracket/Brace">()</span>.<span class="ActionScriptDefault_Text">lng</span><span class="ActionScriptBracket/Brace">()</span>, <span class="ActionScriptDefault_Text">gLatLngBounds</span>.<span class="ActionScriptDefault_Text">getNorthEast</span><span class="ActionScriptBracket/Brace">()</span>.<span class="ActionScriptDefault_Text">lat</span><span class="ActionScriptBracket/Brace">()])</span>;
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptBracket/Brace">{</span><span class="ActionScriptDefault_Text">xmin</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">sw</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">ymin</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">sw</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">xmax</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">ne</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">ymax</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">ne</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">spatialReference</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptBracket/Brace">{</span><span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">spatialReference</span>.<span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptBracket/Brace">}}</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">internal</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">fromLatLngToPoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">gLatLng</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">LatLng</span>, <span class="ActionScriptDefault_Text">sr</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SpatialReference</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:*</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptDefault_Text">sr</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">sr</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">SpatialReferences</span>.<span class="ActionScriptDefault_Text">WGS84</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">sr</span>.<span class="ActionScriptDefault_Text">forward</span><span class="ActionScriptBracket/Brace">([</span><span class="ActionScriptDefault_Text">gLatLng</span>.<span class="ActionScriptDefault_Text">lng</span><span class="ActionScriptBracket/Brace">()</span>, <span class="ActionScriptDefault_Text">gLatLng</span>.<span class="ActionScriptDefault_Text">lat</span><span class="ActionScriptBracket/Brace">()])</span>;
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptBracket/Brace">{</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">spatialReference</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptBracket/Brace">{</span><span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">sr</span>.<span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptBracket/Brace">}}</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">internal</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">fromPointToLatLng</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">point</span><span class="ActionScriptOperator">:*</span>, <span class="ActionScriptDefault_Text">opt_sr</span><span class="ActionScriptOperator">:*=</span><span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">LatLng</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">srid</span><span class="ActionScriptOperator">:*=</span><span class="ActionScriptDefault_Text">point</span>.<span class="ActionScriptDefault_Text">spatialReference</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">opt_sr</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sr</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SpatialReference</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">srid</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">SpatialReferences</span>.<span class="ActionScriptDefault_Text">getSpatialReference</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">srid</span>.<span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">SpatialReferences</span>.<span class="ActionScriptDefault_Text">WGS84</span>;
      <span class="ActionScriptDefault_Text">sr</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">sr</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">SpatialReferences</span>.<span class="ActionScriptDefault_Text">WGS84</span>;
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">point</span>.<span class="ActionScriptDefault_Text">x</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">point</span>.<span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">))</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">null</span>;
      <span class="ActionScriptBracket/Brace">}</span>

      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">sr</span>.<span class="ActionScriptDefault_Text">reverse</span><span class="ActionScriptBracket/Brace">([</span><span class="ActionScriptDefault_Text">point</span>.<span class="ActionScriptDefault_Text">x</span>, <span class="ActionScriptDefault_Text">point</span>.<span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">])</span>;
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">LatLng</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">])</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
     * Add a ArcGIS Server resource to map. if it is cached, it will be added as a map type, if dynamic, it will be added as overlay.
     * @param map
     * @param url
     * @param opt_callback
     *
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addArcGISMap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Map</span>, <span class="ActionScriptDefault_Text">url</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>, <span class="ActionScriptDefault_Text">opt_callback</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Function</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">service</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">MapService</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">MapService</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">url</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptDefault_Text">service</span>.<span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ServiceEvent</span>.<span class="ActionScriptDefault_Text">LOAD</span>, <span class="ActionScriptfunction">function</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">evt</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
          <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">service</span>.<span class="ActionScriptDefault_Text">singleFusedMapCache</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tile</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">ArcGISTileLayer</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ArcGISTileLayer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">service</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">ArcGISMapType</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ArcGISMapType</span><span class="ActionScriptBracket/Brace">([</span><span class="ActionScriptDefault_Text">tile</span><span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ArcGISMapTypeOptions</span><span class="ActionScriptBracket/Brace">({</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">tile</span>.<span class="ActionScriptDefault_Text">getName</span><span class="ActionScriptBracket/Brace">()</span>.<span class="ActionScriptDefault_Text">replace</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">/</span> <span class="ActionScriptOperator">/</span><span class="ActionScriptDefault_Text">g</span>, <span class="ActionScriptString">&apos;\n&apos;</span><span class="ActionScriptBracket/Brace">)}))</span>;
            <span class="ActionScriptDefault_Text">map</span>.<span class="ActionScriptDefault_Text">addMapType</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">type</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">opt_callback</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
              <span class="ActionScriptDefault_Text">opt_callback</span>.<span class="ActionScriptDefault_Text">call</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">null</span>, <span class="ActionScriptDefault_Text">type</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
          <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ov</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">ArcGISMapOverlay</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ArcGISMapOverlay</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">service</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">map</span>.<span class="ActionScriptDefault_Text">addOverlay</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ov</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">opt_callback</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
              <span class="ActionScriptDefault_Text">opt_callback</span>.<span class="ActionScriptDefault_Text">call</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">null</span>, <span class="ActionScriptDefault_Text">ov</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
          <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">})</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
     * Enable wheel zoom as alternative to Map.enableScrollWheelZoom because the later passed zoom=0 to Projection.
     */</span>
    <span class="ActionScriptReserved">internal</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">enableScrollWheelZoom</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">google</span>.<span class="ActionScriptDefault_Text">maps</span>.<span class="ActionScriptDefault_Text">Map</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptDefault_Text">map</span>.<span class="ActionScriptDefault_Text">getDisplayObject</span><span class="ActionScriptBracket/Brace">()</span>.<span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">MouseEvent</span>.<span class="ActionScriptDefault_Text">MOUSE_WHEEL</span>, <span class="ActionScriptfunction">function</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">evt</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">MouseEvent</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
          <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">Point</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">Point</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">evt</span>.<span class="ActionScriptDefault_Text">localX</span>, <span class="ActionScriptDefault_Text">evt</span>.<span class="ActionScriptDefault_Text">localY</span><span class="ActionScriptBracket/Brace">)</span>;
          <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">latlng</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">LatLng</span>;
          <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">c</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">Point</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">Point</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">map</span>.<span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">/</span> 2, <span class="ActionScriptDefault_Text">map</span>.<span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">/</span> 2<span class="ActionScriptBracket/Brace">)</span>;
          <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">z</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">map</span>.<span class="ActionScriptDefault_Text">getZoom</span><span class="ActionScriptBracket/Brace">()</span>;
          <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">evt</span>.<span class="ActionScriptDefault_Text">delta</span> <span class="ActionScriptOperator">&gt;</span> 0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">z</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">min</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">+</span> 1, <span class="ActionScriptDefault_Text">map</span>.<span class="ActionScriptDefault_Text">getMaxZoomLevel</span><span class="ActionScriptBracket/Brace">())</span>;
            <span class="ActionScriptDefault_Text">latlng</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">map</span>.<span class="ActionScriptDefault_Text">fromViewportToLatLng</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">Point</span><span class="ActionScriptBracket/Brace">((</span><span class="ActionScriptDefault_Text">p</span>.<span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">c</span>.<span class="ActionScriptDefault_Text">x</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">/</span> 2, <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span>.<span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">c</span>.<span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">/</span> 2<span class="ActionScriptBracket/Brace">))</span>;
          <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">z</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">max</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">-</span> 1, <span class="ActionScriptDefault_Text">map</span>.<span class="ActionScriptDefault_Text">getMinZoomLevel</span><span class="ActionScriptBracket/Brace">())</span>;
            <span class="ActionScriptDefault_Text">latlng</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">map</span>.<span class="ActionScriptDefault_Text">fromViewportToLatLng</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">Point</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">c</span>.<span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">*</span> 2 <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">p</span>.<span class="ActionScriptDefault_Text">x</span>, <span class="ActionScriptDefault_Text">c</span>.<span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">*</span> 2 <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">p</span>.<span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">))</span>;
          <span class="ActionScriptBracket/Brace">}</span>
          <span class="ActionScriptDefault_Text">map</span>.<span class="ActionScriptDefault_Text">setCenter</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">latlng</span>, <span class="ActionScriptDefault_Text">z</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">})</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">internal</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ArcGISConfig</span><span class="ActionScriptOperator">:*=</span><span class="ActionScriptBracket/Brace">{</span><span class="ActionScriptDefault_Text">maxPolyPoints</span><span class="ActionScriptOperator">:</span> 3000, <span class="ActionScriptDefault_Text">style</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptBracket/Brace">{</span><span class="ActionScriptDefault_Text">icon</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptReserved">null</span>, <span class="ActionScriptDefault_Text">strokeStyle</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptBracket/Brace">{</span><span class="ActionScriptDefault_Text">thickness</span><span class="ActionScriptOperator">:</span> 3, <span class="ActionScriptDefault_Text">color</span><span class="ActionScriptOperator">:</span> 0<span class="ActionScriptDefault_Text">xffff00</span>, <span class="ActionScriptDefault_Text">alpha</span><span class="ActionScriptOperator">:</span> 0.5, <span class="ActionScriptDefault_Text">pixelHinting</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">}</span>, <span class="ActionScriptDefault_Text">fillStyle</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptBracket/Brace">{</span><span class="ActionScriptDefault_Text">color</span><span class="ActionScriptOperator">:</span> 0<span class="ActionScriptDefault_Text">xFFFF00</span>, <span class="ActionScriptDefault_Text">alpha</span><span class="ActionScriptOperator">:</span> 0.5<span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptBracket/Brace">}}</span>;

    <span class="ActionScriptASDoc">/**
     * Convert a {@link ArcGISFeature} or {@link ArcGISIdentifyResult} or {@link ArcGISFindResult} to core Google Maps API
     * overlays such as  {@link ArcGISGMarker},
     * {@link ArcGISGPolyline}, or {@link ArcGISGPolygon}s.
     * Note ArcGIS Geometry may have multiple parts, but the coresponding GOverlay
     * does not  support multi-parts, so the result is an array.
     * &lt;ul&gt;&lt;li&gt;&lt;code&gt;feature&lt;/code&gt;: an object returned by ArcGIS Server with at least &lt;code&gt;geometry&lt;/code&gt; property of type {@link ArcGISGeometry}.
     *  if it contains a name-value pair &quot;attributes&quot; property, it will be attached to the result overlays.
     * &lt;li&gt;&lt;code&gt;opt_sr&lt;/code&gt;: optional {@link ArcGISSpatialReference}. Can be object literal.
     * &lt;li&gt;&lt;code&gt;opt_agsStyle&lt;/code&gt; {@link ArcGISStyleOptions}. default is {@link ArcGISConfig}.style.
     * &lt;li&gt;&lt;code&gt;opt_displayName&lt;/code&gt; optional field name used for title of feature.
     * @param {Feature} feature
     * @param {ArcGISSpatialReference} opt_sr
     * @param {overlayOptions} opt_agsStyle
     * @param {String} opt_displayName
     * @return {GOverlay[]}
     */</span>

    <span class="ActionScriptReserved">internal</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">fromGeometryToOverlays</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">geom</span><span class="ActionScriptOperator">:*</span>, <span class="ActionScriptDefault_Text">opt_sr</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SpatialReference</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span>, <span class="ActionScriptDefault_Text">overlayOptions</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">OverlayOptions</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span>, <span class="ActionScriptDefault_Text">title</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">&apos;&apos;</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ovs</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">[]</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sr</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SpatialReference</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ov</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">IOverlay</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span>;
      <span class="ActionScriptDefault_Text">overlayOptions</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">overlayOptions</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">OverlayOptions</span><span class="ActionScriptBracket/Brace">()</span>;
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">opt_sr</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">sr</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">opt_sr</span>;
      <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">sr</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">SpatialReferences</span>.<span class="ActionScriptDefault_Text">getSpatialReference</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">spatialReference</span>.<span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sr</span> <span class="ActionScriptOperator">===</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">ovs</span>;
      <span class="ActionScriptBracket/Brace">}</span>

      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>, <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>, <span class="ActionScriptDefault_Text">ic</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>, <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>, <span class="ActionScriptDefault_Text">jc</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>, <span class="ActionScriptDefault_Text">parts</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>, <span class="ActionScriptDefault_Text">part</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>, <span class="ActionScriptDefault_Text">lnglat</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>, <span class="ActionScriptDefault_Text">glatlngs</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;

      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">x</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptComment">//point
</span>        <span class="ActionScriptDefault_Text">lnglat</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">sr</span>.<span class="ActionScriptDefault_Text">reverse</span><span class="ActionScriptBracket/Brace">([</span><span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">x</span>, <span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">])</span>;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">overlayOptions</span>.<span class="ActionScriptDefault_Text">marker</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
          <span class="ActionScriptDefault_Text">overlayOptions</span>.<span class="ActionScriptDefault_Text">marker</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">MarkerOptions</span><span class="ActionScriptBracket/Brace">({</span><span class="ActionScriptDefault_Text">tooltip</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">title</span><span class="ActionScriptBracket/Brace">})</span>;
        <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">overlayOptions</span>.<span class="ActionScriptDefault_Text">marker</span>.<span class="ActionScriptDefault_Text">tooltip</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
          <span class="ActionScriptDefault_Text">overlayOptions</span>.<span class="ActionScriptDefault_Text">marker</span>.<span class="ActionScriptDefault_Text">tooltip</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">title</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptDefault_Text">ov</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Marker</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">LatLng</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lnglat</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">lnglat</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">])</span>, <span class="ActionScriptDefault_Text">overlayOptions</span>.<span class="ActionScriptDefault_Text">marker</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">ovs</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ov</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptComment">//mulpt, line and poly
</span>        <span class="ActionScriptDefault_Text">parts</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">points</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">paths</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">rings</span>;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">parts</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
          <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">ovs</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0, <span class="ActionScriptDefault_Text">ic</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">parts</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">ic</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
          <span class="ActionScriptDefault_Text">part</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">parts</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
          <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">points</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">// multipoint
</span>            <span class="ActionScriptDefault_Text">lnglat</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">sr</span>.<span class="ActionScriptDefault_Text">reverse</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">part</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">ov</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Marker</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">LatLng</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lnglat</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">lnglat</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">])</span>, <span class="ActionScriptDefault_Text">overlayOptions</span>.<span class="ActionScriptDefault_Text">marker</span><span class="ActionScriptBracket/Brace">)</span>;
          <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">part</span>.<span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">&gt;</span> <span class="ActionScriptDefault_Text">ArcGISConfig</span>.<span class="ActionScriptDefault_Text">maxPolyPoints</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
              <span class="ActionScriptComment">// TODO: do a simple point reduction 
</span>              <span class="ActionScriptReserved">continue</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptDefault_Text">glatlngs</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">[]</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">=</span>0, <span class="ActionScriptDefault_Text">jc</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">part</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">jc</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
              <span class="ActionScriptDefault_Text">lnglat</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">sr</span>.<span class="ActionScriptDefault_Text">reverse</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">part</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">])</span>;
              <span class="ActionScriptDefault_Text">glatlngs</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">LatLng</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lnglat</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">lnglat</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]))</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">paths</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>

              <span class="ActionScriptDefault_Text">ov</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Polyline</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">glatlngs</span>, <span class="ActionScriptDefault_Text">overlayOptions</span>.<span class="ActionScriptDefault_Text">polyline</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//new PolylineOptions({strokeStyle: style.strokeStyle}));
</span>            <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">rings</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
              <span class="ActionScriptDefault_Text">overlayOptions</span>.<span class="ActionScriptDefault_Text">polygon</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">overlayOptions</span>.<span class="ActionScriptDefault_Text">polygon</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">PolygonOptions</span><span class="ActionScriptBracket/Brace">()</span>;
              <span class="ActionScriptDefault_Text">overlayOptions</span>.<span class="ActionScriptDefault_Text">polygon</span>.<span class="ActionScriptDefault_Text">tooltip</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">title</span>;
              <span class="ActionScriptDefault_Text">ov</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Polygon</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">glatlngs</span>, <span class="ActionScriptDefault_Text">overlayOptions</span>.<span class="ActionScriptDefault_Text">polygon</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//new PolygonOptions({strokeStyle: style.strokeStyle, fillStyle: style.fillStyle, tooltip: title})); //, style.outlineColor, style.outlineWeight, style.outlineOpacity, style.fillColor, style.fillOpacity);
</span>            <span class="ActionScriptBracket/Brace">}</span>
          <span class="ActionScriptBracket/Brace">}</span>
          <span class="ActionScriptDefault_Text">ovs</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ov</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">ovs</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">internal</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">fromOverlaysToGeometry</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ovs</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>, <span class="ActionScriptDefault_Text">opt_sr</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SpatialReference</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:*</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sr</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SpatialReference</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span>;
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">opt_sr</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">sr</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">opt_sr</span>;
      <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">sr</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">SpatialReferences</span>.<span class="ActionScriptDefault_Text">WGS84</span>;
      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ov</span><span class="ActionScriptOperator">:*</span>;
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">ovs</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">ovs</span>.<span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">==</span> 0<span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">null</span>;
      <span class="ActionScriptDefault_Text">ov</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">ovs</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>, <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>, <span class="ActionScriptDefault_Text">ic</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>, <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>, <span class="ActionScriptDefault_Text">jc</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>, <span class="ActionScriptDefault_Text">parts</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>, <span class="ActionScriptDefault_Text">part</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>, <span class="ActionScriptDefault_Text">ll</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">LatLng</span>, <span class="ActionScriptDefault_Text">lnglat</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>;
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ovs</span>.<span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">==</span> 1 <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ov</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">LatLng</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">ov</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">Marker</span><span class="ActionScriptBracket/Brace">))</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">ll</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ov</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">LatLng</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">ov</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">LatLng</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ov</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">Marker</span><span class="ActionScriptBracket/Brace">)</span>.<span class="ActionScriptDefault_Text">getLatLng</span><span class="ActionScriptBracket/Brace">())</span>;
        <span class="ActionScriptDefault_Text">lnglat</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">sr</span>.<span class="ActionScriptDefault_Text">forward</span><span class="ActionScriptBracket/Brace">([</span><span class="ActionScriptDefault_Text">ll</span>.<span class="ActionScriptDefault_Text">lng</span><span class="ActionScriptBracket/Brace">()</span>, <span class="ActionScriptDefault_Text">ll</span>.<span class="ActionScriptDefault_Text">lat</span><span class="ActionScriptBracket/Brace">()])</span>;
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptBracket/Brace">{</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">lnglat</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">lnglat</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span>, <span class="ActionScriptDefault_Text">spatialReference</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptBracket/Brace">{</span><span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">sr</span>.<span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptBracket/Brace">}}</span>;
      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptDefault_Text">parts</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">[]</span>;
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ov</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">LatLng</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">ovs</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
          <span class="ActionScriptDefault_Text">ll</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">ovs</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">LatLng</span>;
          <span class="ActionScriptDefault_Text">parts</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sr</span>.<span class="ActionScriptDefault_Text">forward</span><span class="ActionScriptBracket/Brace">([</span><span class="ActionScriptDefault_Text">ll</span>.<span class="ActionScriptDefault_Text">lng</span><span class="ActionScriptBracket/Brace">()</span>, <span class="ActionScriptDefault_Text">ll</span>.<span class="ActionScriptDefault_Text">lat</span><span class="ActionScriptBracket/Brace">()]))</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptBracket/Brace">{</span><span class="ActionScriptDefault_Text">points</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">parts</span>, <span class="ActionScriptDefault_Text">spatialReference</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptBracket/Brace">{</span><span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">sr</span>.<span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptBracket/Brace">}}</span>;
      <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ov</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">Marker</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">ovs</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
          <span class="ActionScriptDefault_Text">ll</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ovs</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">Marker</span><span class="ActionScriptBracket/Brace">)</span>.<span class="ActionScriptDefault_Text">getLatLng</span><span class="ActionScriptBracket/Brace">()</span>;
          <span class="ActionScriptDefault_Text">parts</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sr</span>.<span class="ActionScriptDefault_Text">forward</span><span class="ActionScriptBracket/Brace">([</span><span class="ActionScriptDefault_Text">ll</span>.<span class="ActionScriptDefault_Text">lng</span><span class="ActionScriptBracket/Brace">()</span>, <span class="ActionScriptDefault_Text">ll</span>.<span class="ActionScriptDefault_Text">lat</span><span class="ActionScriptBracket/Brace">()]))</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptBracket/Brace">{</span><span class="ActionScriptDefault_Text">points</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">parts</span>, <span class="ActionScriptDefault_Text">spatialReference</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptBracket/Brace">{</span><span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">sr</span>.<span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptBracket/Brace">}}</span>;
      <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ov</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">Polyline</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">ov</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">Polygon</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">ovs</span>.<span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
          <span class="ActionScriptDefault_Text">part</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">[]</span>;
          <span class="ActionScriptComment">//var line:Polyline = ovs[i] as Polyline;
</span>          <span class="ActionScriptDefault_Text">ov</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">ovs</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
          <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">ov</span>.<span class="ActionScriptDefault_Text">getVertexCount</span><span class="ActionScriptBracket/Brace">()</span>; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">ll</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">ov</span>.<span class="ActionScriptDefault_Text">getVertex</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">part</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sr</span>.<span class="ActionScriptDefault_Text">forward</span><span class="ActionScriptBracket/Brace">([</span><span class="ActionScriptDefault_Text">ll</span>.<span class="ActionScriptDefault_Text">lng</span><span class="ActionScriptBracket/Brace">()</span>, <span class="ActionScriptDefault_Text">ll</span>.<span class="ActionScriptDefault_Text">lat</span><span class="ActionScriptBracket/Brace">()]))</span>;
          <span class="ActionScriptBracket/Brace">}</span>
          <span class="ActionScriptDefault_Text">parts</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">part</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ov</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">Polyline</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
          <span class="ActionScriptReserved">return</span> <span class="ActionScriptBracket/Brace">{</span><span class="ActionScriptDefault_Text">paths</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">parts</span>, <span class="ActionScriptDefault_Text">spatialReference</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptBracket/Brace">{</span><span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">sr</span>.<span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptBracket/Brace">}}</span>;
        <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptBracket/Brace">{</span>
          <span class="ActionScriptReserved">return</span> <span class="ActionScriptBracket/Brace">{</span><span class="ActionScriptDefault_Text">rings</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">parts</span>, <span class="ActionScriptDefault_Text">spatialReference</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptBracket/Brace">{</span><span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">sr</span>.<span class="ActionScriptDefault_Text">wkid</span><span class="ActionScriptBracket/Brace">}}</span>;
        <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">internal</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">restRequest</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">url</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>, <span class="ActionScriptDefault_Text">params</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Object</span>, <span class="ActionScriptDefault_Text">thisObj</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">IEventDispatcher</span>, <span class="ActionScriptDefault_Text">sucessFn</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Function</span>, <span class="ActionScriptDefault_Text">failFn</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Function</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">full</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">url</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">url</span>.<span class="ActionScriptDefault_Text">indexOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&apos;?&apos;</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">===</span> <span class="ActionScriptOperator">-</span>1 <span class="ActionScriptOperator">?</span> <span class="ActionScriptString">&apos;?&apos;</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptString">&apos;&amp;&apos;</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptComment">/*
         var service:HTTPService=new HTTPService();
         service.url=url;
         service.addEventListener(FaultEvent.FAULT, function(evt:FaultEvent):void {
         var err:ServiceError=new ServiceError({code: -1, message: evt.toString(), details: []});
         if (thisObj != null) {
         thisObj.dispatchEvent(new ServiceEvent(ServiceEvent.ERROR, err));
         }
         if (failFn != null) {
         failFn(thisObj, err);
         }
         });
         service.addEventListener(ResultEvent.RESULT, function(evt:ResultEvent):void {
         var jsons:String=evt.result as String;
         var d:JSONDecoder=new JSONDecoder(jsons, false); // false strict to allow NAN in geocode results
         var json:Object=d.getValue();
         if (json.error) {
         var err:ServiceError=new ServiceError(json.error);
         thisObj.dispatchEvent(new ServiceEvent(ServiceEvent.ERROR, err));
         if (failFn != null) {
         failFn.call(thisObj, err);
         }
         } else if (sucessFn != null) {
         sucessFn.call(thisObj, json);
         }
         });
         service.send(params);
       */</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">variables</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">URLVariables</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">URLVariables</span><span class="ActionScriptBracket/Brace">()</span>;
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">params</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">params</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
          <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">params</span>.<span class="ActionScriptDefault_Text">hasOwnProperty</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptBracket/Brace">))</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//full+=(x + &apos;=&apos; + escape(params[x]) + &apos;&amp;&apos;);
</span>            <span class="ActionScriptDefault_Text">variables</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">params</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptBracket/Brace">]</span>;
          <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptBracket/Brace">}</span>

      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">loader</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">URLLoader</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">URLLoader</span><span class="ActionScriptBracket/Brace">()</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">request</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">URLRequest</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">URLRequest</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">full</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptDefault_Text">request</span>.<span class="ActionScriptDefault_Text">method</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">URLRequestMethod</span>.<span class="ActionScriptDefault_Text">GET</span>; <span class="ActionScriptComment">//.POST;  
</span>      <span class="ActionScriptDefault_Text">request</span>.<span class="ActionScriptDefault_Text">data</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">variables</span>;

      <span class="ActionScriptDefault_Text">loader</span>.<span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Event</span>.<span class="ActionScriptDefault_Text">COMPLETE</span>, <span class="ActionScriptfunction">function</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">evt</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
          <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">jsons</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">evt</span>.<span class="ActionScriptDefault_Text">target</span>.<span class="ActionScriptDefault_Text">data</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">String</span>;
          <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">d</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">JSONDecoder</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">JSONDecoder</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">jsons</span>, <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">// false strict to allow NAN in geocode results
</span>          <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">json</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">d</span>.<span class="ActionScriptDefault_Text">getValue</span><span class="ActionScriptBracket/Brace">()</span>;
          <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">json</span>.<span class="ActionScriptDefault_Text">error</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">err</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">ServiceError</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ServiceError</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">json</span>.<span class="ActionScriptDefault_Text">error</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">thisObj</span>.<span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ServiceEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ServiceEvent</span>.<span class="ActionScriptDefault_Text">ERROR</span>, <span class="ActionScriptDefault_Text">err</span><span class="ActionScriptBracket/Brace">))</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">failFn</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
              <span class="ActionScriptDefault_Text">failFn</span>.<span class="ActionScriptDefault_Text">call</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">thisObj</span>, <span class="ActionScriptDefault_Text">err</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
          <span class="ActionScriptBracket/Brace">}</span> <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sucessFn</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">sucessFn</span>.<span class="ActionScriptDefault_Text">call</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">thisObj</span>, <span class="ActionScriptDefault_Text">json</span><span class="ActionScriptBracket/Brace">)</span>;
          <span class="ActionScriptBracket/Brace">}</span>


        <span class="ActionScriptBracket/Brace">})</span>;
      <span class="ActionScriptDefault_Text">loader</span>.<span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">IOErrorEvent</span>.<span class="ActionScriptDefault_Text">IO_ERROR</span>, <span class="ActionScriptfunction">function</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">evt</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">IOErrorEvent</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
          <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">err</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">ServiceError</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ServiceError</span><span class="ActionScriptBracket/Brace">({</span><span class="ActionScriptDefault_Text">code</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptOperator">-</span>1, <span class="ActionScriptDefault_Text">message</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">evt</span>.<span class="ActionScriptDefault_Text">toString</span><span class="ActionScriptBracket/Brace">()</span>, <span class="ActionScriptDefault_Text">details</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptBracket/Brace">[]})</span>;
          <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">thisObj</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">thisObj</span>.<span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ServiceEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ServiceEvent</span>.<span class="ActionScriptDefault_Text">ERROR</span>, <span class="ActionScriptDefault_Text">err</span><span class="ActionScriptBracket/Brace">))</span>;
          <span class="ActionScriptBracket/Brace">}</span>
          <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">failFn</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">failFn</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">thisObj</span>, <span class="ActionScriptDefault_Text">err</span><span class="ActionScriptBracket/Brace">)</span>;
          <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptBracket/Brace">})</span>;
      <span class="ActionScriptDefault_Text">loader</span>.<span class="ActionScriptDefault_Text">load</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">request</span><span class="ActionScriptBracket/Brace">)</span>;

    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
     * Extract the substring from full string, between start string and end string
     * @param {Object} full
     * @param {Object} start
     * @param {Object} end
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">extractString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">full</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>, <span class="ActionScriptDefault_Text">start</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>, <span class="ActionScriptDefault_Text">end</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">start</span> <span class="ActionScriptOperator">===</span> <span class="ActionScriptString">&apos;&apos;</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> 0 <span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">full</span>.<span class="ActionScriptDefault_Text">indexOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">start</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">e</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">end</span> <span class="ActionScriptOperator">===</span> <span class="ActionScriptString">&apos;&apos;</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">full</span>.<span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">full</span>.<span class="ActionScriptDefault_Text">indexOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">end</span>, <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">start</span>.<span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">full</span>.<span class="ActionScriptDefault_Text">substring</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">start</span>.<span class="ActionScriptDefault_Text">length</span>, <span class="ActionScriptDefault_Text">e</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">internal</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">augmentObject</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">src</span><span class="ActionScriptOperator">:*</span>, <span class="ActionScriptDefault_Text">dest</span><span class="ActionScriptOperator">:*</span>, <span class="ActionScriptDefault_Text">force</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">src</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">dest</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>;
        <span class="ActionScriptComment">// used to count/check if it is a dyna class 
</span>        <span class="ActionScriptComment">// with properties that can be looped with for.. in
</span>        <span class="ActionScriptComment">// In AS3, for..in can not be used to loop properties of a class instance except those 
</span>        <span class="ActionScriptComment">// dynamic added. That makes converting parameter classes into REST request harder.
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0;
        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">src</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
          <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span>;
          <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">src</span>.<span class="ActionScriptDefault_Text">hasOwnProperty</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">))</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">force</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">dest</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">p</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">dest</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">dest</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]))</span> <span class="ActionScriptBracket/Brace">{</span>
              <span class="ActionScriptDefault_Text">dest</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">src</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptBracket/Brace">}</span>
          <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">==</span> 0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
          <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">varList</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">XMLList</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">utils</span>.<span class="ActionScriptDefault_Text">describeType</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">src</span><span class="ActionScriptBracket/Brace">)</span>..<span class="ActionScriptDefault_Text">variable</span>;
          <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">varList</span>.<span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">()</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">varList</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>.@<span class="ActionScriptDefault_Text">name</span>;
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">src</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">])</span> <span class="ActionScriptBracket/Brace">{</span>
              <span class="ActionScriptDefault_Text">dest</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">src</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptBracket/Brace">}</span>
          <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">dest</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">internal</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">isString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">o</span><span class="ActionScriptOperator">:*</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">o</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">o</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">String</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">internal</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">isArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">o</span><span class="ActionScriptOperator">:*</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">o</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">o</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">Array</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getAttributeValue</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">attrs</span><span class="ActionScriptOperator">:*</span>, <span class="ActionScriptDefault_Text">name</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:*</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">attrs</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">])</span>
        <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">attrs</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">]</span>;
      <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">attrs</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">x</span>.<span class="ActionScriptDefault_Text">toUpperCase</span><span class="ActionScriptBracket/Brace">()</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">name</span>.<span class="ActionScriptDefault_Text">toUpperCase</span><span class="ActionScriptBracket/Brace">())</span> <span class="ActionScriptBracket/Brace">{</span>
          <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">attrs</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptBracket/Brace">]</span>;
        <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">null</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">internal</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">fromGeometryToJSON</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">geom</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Object</span>, <span class="ActionScriptDefault_Text">opt_includeSR</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptComment">/*function fromPointsToJSON(pts) {
         var arr = [];
         for (var i = 0, c = pts.length; i &lt; c; i++) {
         arr.push(&apos;[&apos; + pts[i][0] + &apos;,&apos; + pts[i][1] + &apos;]&apos;);
         }
         return &apos;[&apos; + arr.join(&apos;,&apos;) + &apos;]&apos;;
         }
         function fromLinesToJSON(lines) {
         var arr = [];
         for (var i = 0, c = lines.length; i &lt; c; i++) {
         arr.push(fromPointsToJSON(lines[i]));
         }
         return &apos;[&apos; + arr.join(&apos;,&apos;) + &apos;]&apos;;
         }

         var json = &apos;{&apos;;
         if (geom.x) {
         json += &apos;x:&apos; + geom.x + &apos;,y:&apos; + geom.y;
         } else if (geom.xmin) {
         json += &apos;xmin:&apos; + geom.xmin + &apos;,ymin:&apos; + geom.ymin + &apos;,xmax:&apos; + geom.xmax + &apos;,ymax:&apos; + geom.ymax;
         } else if (geom.points) {
         json += &apos;points:&apos; + fromPointsToJSON(geom.points);
         } else if (geom.paths) {
         json += &apos;paths:&apos; + fromLinesToJSON(geom.paths);
         } else if (geom.rings) {
         json += &apos;rings:&apos; + fromLinesToJSON(geom.rings);
         }
         if (opt_includeSR &amp;&amp; geom.spatialReference) {
         json += &apos;,spatialReference:{wkid:&apos; + geom.spatialReference.wkid + &apos;}&apos;;
         }
         json += &apos;}&apos;;
         return json;
       */</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">e</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">JSONEncoder</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">JSONEncoder</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">geom</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">e</span>.<span class="ActionScriptDefault_Text">getString</span><span class="ActionScriptBracket/Brace">()</span>;
    <span class="ActionScriptBracket/Brace">}</span>
  <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptBracket/Brace">}</span></pre></body>
</html>
