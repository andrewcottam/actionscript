<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>ScribbleOverlayLayer.as</title>
<link rel="stylesheet" type="text/css" href="../../../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptComment">/* file            scribbleoverlaylayer.as
date            oct 2009
author            andrew cottam
description        derived from the google overlaybase class this class is used to show a user defined area over as a custom overlay in the google map api
                a user can draw a freehand polygon and this can be used to do spatial queries and overlays
                the class needs initialising from the calling component and finalising 
*/</span>
<span class="ActionScriptpackage">package</span> <span class="ActionScriptDefault_Text">wcmc</span>.<span class="ActionScriptDefault_Text">classes</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">esri</span>.<span class="ActionScriptDefault_Text">ags</span>.<span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">MapPoint</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">esri</span>.<span class="ActionScriptDefault_Text">ags</span>.<span class="ActionScriptDefault_Text">geometry</span>.<span class="ActionScriptDefault_Text">Polygon</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">google</span>.<span class="ActionScriptDefault_Text">maps</span>.<span class="ActionScriptDefault_Text">LatLng</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">google</span>.<span class="ActionScriptDefault_Text">maps</span>.<span class="ActionScriptDefault_Text">Map</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">google</span>.<span class="ActionScriptDefault_Text">maps</span>.<span class="ActionScriptDefault_Text">Map3D</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">google</span>.<span class="ActionScriptDefault_Text">maps</span>.<span class="ActionScriptDefault_Text">MapAction</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">google</span>.<span class="ActionScriptDefault_Text">maps</span>.<span class="ActionScriptDefault_Text">PaneId</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">google</span>.<span class="ActionScriptDefault_Text">maps</span>.<span class="ActionScriptDefault_Text">interfaces</span>.<span class="ActionScriptDefault_Text">IMap</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">google</span>.<span class="ActionScriptDefault_Text">maps</span>.<span class="ActionScriptDefault_Text">interfaces</span>.<span class="ActionScriptDefault_Text">IPane</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">google</span>.<span class="ActionScriptDefault_Text">maps</span>.<span class="ActionScriptDefault_Text">overlays</span>.<span class="ActionScriptDefault_Text">OverlayBase</span>;
    
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">events</span>.<span class="ActionScriptDefault_Text">Event</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">events</span>.<span class="ActionScriptDefault_Text">MouseEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">Point</span>;
    
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span>.<span class="ActionScriptDefault_Text">containers</span>.<span class="ActionScriptDefault_Text">Canvas</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span>.<span class="ActionScriptDefault_Text">controls</span>.<span class="ActionScriptDefault_Text">Alert</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span>.<span class="ActionScriptDefault_Text">events</span>.<span class="ActionScriptDefault_Text">FlexEvent</span>;
        
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">ScribbleOverlayLayer</span> <span class="ActionScriptReserved">extends</span> <span class="ActionScriptDefault_Text">OverlayBase</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">canvas</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Canvas</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Canvas</span><span class="ActionScriptBracket/Brace">()</span>; <span class="ActionScriptComment">//contains the actual drawing that the user creates
</span>        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">originX</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>; <span class="ActionScriptComment">//start x coordinate of the scribble or circle
</span>        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">originY</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>; <span class="ActionScriptComment">//start y coordinate of the scribble or circle
</span>        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">points</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>; <span class="ActionScriptComment">//contains the array of points that the user has digitised (as mouse coordinates)
</span>        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lastPoints</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span>; <span class="ActionScriptComment">//the last points that were digitised
</span>        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Bindable</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">drawMode</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>; <span class="ActionScriptComment">//currently scribble or circle
</span>        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Event</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">&quot;UDACreated&quot;</span>, <span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">&quot;wcmc.classes.UDACreatedEvent&quot;</span><span class="ActionScriptBracket/Brace">)]</span> <span class="ActionScriptComment">//custom event that clients can attach a handler onto
</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">ScribbleOverlayLayer</span><span class="ActionScriptBracket/Brace">()</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">super</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FlexEvent</span>.<span class="ActionScriptDefault_Text">CREATION_COMPLETE</span>,<span class="ActionScriptDefault_Text">addCanvas</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//add the canvas when the scribble layer is completely loaded
</span>        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptComment">//this should be called before the user can digitise anything
</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">initialise</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_map</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Map3D</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">clearCanvas</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptDefault_Text">_map</span>.<span class="ActionScriptDefault_Text">disableDragging</span><span class="ActionScriptBracket/Brace">()</span>; <span class="ActionScriptComment">//otherwise the user will not be able to scribble with the mouse - it would simply move the map
</span>            <span class="ActionScriptDefault_Text">_map</span>.<span class="ActionScriptDefault_Text">setDoubleClickMode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">MapAction</span>.<span class="ActionScriptDefault_Text">ACTION_NOTHING</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//similarly, we need to disable double click so the user can complete the digitising
</span>            <span class="ActionScriptDefault_Text">_map</span>.<span class="ActionScriptDefault_Text">addOverlay</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//add the scribble overlay to the google map
</span>        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptComment">//this should be called when the user has dinished digitising
</span>        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">finalise</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_map</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Map3D</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>            
            <span class="ActionScriptDefault_Text">clearCanvas</span><span class="ActionScriptBracket/Brace">()</span>;
            <span class="ActionScriptDefault_Text">_map</span>.<span class="ActionScriptDefault_Text">enableDragging</span><span class="ActionScriptBracket/Brace">()</span>; <span class="ActionScriptComment">//reset the draggin 
</span>            <span class="ActionScriptDefault_Text">_map</span>.<span class="ActionScriptDefault_Text">setDoubleClickMode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">MapAction</span>.<span class="ActionScriptDefault_Text">ACTION_PAN_ZOOM_IN</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//reset the double click action
</span>            <span class="ActionScriptDefault_Text">_map</span>.<span class="ActionScriptDefault_Text">removeOverlay</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//remove this overlay from the google map
</span>        <span class="ActionScriptBracket/Brace">}</span>    
        <span class="ActionScriptComment">//resets the canvas ready for the next drawing operation
</span>        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">clearCanvas</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">lastPoints</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">[]</span>;<span class="ActionScriptComment">//needs to be reset since PositionOverlay is called everytime the user zooms or pans-i.e. the scribble will be redrawn 
</span>            <span class="ActionScriptDefault_Text">originX</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">NaN</span>; <span class="ActionScriptComment">//reset the origin x
</span>            <span class="ActionScriptDefault_Text">originY</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">NaN</span>; <span class="ActionScriptComment">//and y
</span>            <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">clear</span><span class="ActionScriptBracket/Brace">()</span>; <span class="ActionScriptComment">//clear the canvas
</span>        <span class="ActionScriptBracket/Brace">}</span>   
        <span class="ActionScriptComment">//add the canvas to this object and set its size     
</span>        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addCanvas</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">FlexEvent</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">pane</span>.<span class="ActionScriptDefault_Text">map</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">Map</span><span class="ActionScriptBracket/Brace">)</span>.<span class="ActionScriptDefault_Text">width</span>;
            <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">pane</span>.<span class="ActionScriptDefault_Text">map</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">Map</span><span class="ActionScriptBracket/Brace">)</span>.<span class="ActionScriptDefault_Text">height</span>;
            <span class="ActionScriptDefault_Text">addChild</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">canvas</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">MouseEvent</span>.<span class="ActionScriptDefault_Text">MOUSE_MOVE</span>,<span class="ActionScriptDefault_Text">_mouseMove</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//wire up the mouse move event
</span>            <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">MouseEvent</span>.<span class="ActionScriptDefault_Text">MOUSE_UP</span>,<span class="ActionScriptDefault_Text">_mouseUp</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//wire up the mouse up event
</span>        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptComment">//called when the mouse moves over the canvas
</span>        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">_mouseMove</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">MouseEvent</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">((!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">originX</span><span class="ActionScriptBracket/Brace">))</span><span class="ActionScriptOperator">&amp;&amp;</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>.<span class="ActionScriptDefault_Text">buttonDown</span><span class="ActionScriptBracket/Brace">))</span> <span class="ActionScriptComment">//if we have already started to digitise a polygon and the mouse is down
</span>            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">points</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">({</span><span class="ActionScriptDefault_Text">X</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">event</span>.<span class="ActionScriptDefault_Text">localX</span>,<span class="ActionScriptDefault_Text">Y</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">event</span>.<span class="ActionScriptDefault_Text">localY</span><span class="ActionScriptBracket/Brace">})</span>; <span class="ActionScriptComment">//add a point to the array of mouse points
</span>                <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">clear</span><span class="ActionScriptBracket/Brace">()</span>; <span class="ActionScriptComment">//clear everything that is already on the canvas
</span>                <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">beginFill</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptDefault_Text">x000000</span>,0.3<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//set the fill style
</span>                <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">moveTo</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">originX</span>,<span class="ActionScriptDefault_Text">originY</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//move to the origin to redraw the whole polygon
</span>                <span class="ActionScriptReserved">switch</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">drawMode</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;Circle&quot;</span><span class="ActionScriptOperator">:</span> <span class="ActionScriptComment">//draw a circle with the radius set the new mouse poition 
</span>                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">radius</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">sqrt</span><span class="ActionScriptBracket/Brace">((</span><span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">pow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>.<span class="ActionScriptDefault_Text">localX</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">originX</span>,2<span class="ActionScriptBracket/Brace">))</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">pow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>.<span class="ActionScriptDefault_Text">localY</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">originY</span>,2<span class="ActionScriptBracket/Brace">)))</span>;
                        <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">drawCircle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">originX</span>,<span class="ActionScriptDefault_Text">originY</span>,<span class="ActionScriptDefault_Text">radius</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">endFill</span><span class="ActionScriptBracket/Brace">()</span>;
                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;Freehand&quot;</span><span class="ActionScriptOperator">:</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">point</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">points</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">//iterate through all the points in the array and redraw the whole polygon up to the new point
</span>                        <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">lineTo</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">point</span>.<span class="ActionScriptDefault_Text">X</span>,<span class="ActionScriptDefault_Text">point</span>.<span class="ActionScriptDefault_Text">Y</span><span class="ActionScriptBracket/Brace">)</span>;                        
                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">endFill</span><span class="ActionScriptBracket/Brace">()</span>; <span class="ActionScriptComment">//complete the polygon
</span>                        <span class="ActionScriptReserved">break</span>;
                    <span class="ActionScriptBracket/Brace">}</span>                    
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptComment">//the user is creating a first point
</span>            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>.<span class="ActionScriptDefault_Text">buttonDown</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">originX</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">event</span>.<span class="ActionScriptDefault_Text">localX</span>;
                    <span class="ActionScriptDefault_Text">originY</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">event</span>.<span class="ActionScriptDefault_Text">localY</span>;
                    <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;StartUDADraw&quot;</span><span class="ActionScriptBracket/Brace">))</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">_mouseUp</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">MouseEvent</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptComment">//user has completed drawing the user-defined area
</span>        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">clear</span><span class="ActionScriptBracket/Brace">()</span>; <span class="ActionScriptComment">//clear the existing UDA
</span>            <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">beginFill</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptDefault_Text">x000000</span>,0.1<span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//set the fill style
</span>            <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">lineStyle</span><span class="ActionScriptBracket/Brace">(</span>1,0<span class="ActionScriptDefault_Text">x000000</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//set the line style
</span>            <span class="ActionScriptReserved">switch</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">drawMode</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;Freehand&quot;</span><span class="ActionScriptOperator">:</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">moveTo</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">originX</span>,<span class="ActionScriptDefault_Text">originY</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//move to the origin and draw the whole polygon
</span>                    <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">point</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">points</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">lineTo</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">point</span>.<span class="ActionScriptDefault_Text">X</span>,<span class="ActionScriptDefault_Text">point</span>.<span class="ActionScriptDefault_Text">Y</span><span class="ActionScriptBracket/Brace">)</span>;                        
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">endFill</span><span class="ActionScriptBracket/Brace">()</span>;
                    <span class="ActionScriptReserved">break</span>;                    
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">&quot;Circle&quot;</span><span class="ActionScriptOperator">:</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">radius</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">sqrt</span><span class="ActionScriptBracket/Brace">((</span><span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">pow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>.<span class="ActionScriptDefault_Text">localX</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">originX</span>,2<span class="ActionScriptBracket/Brace">))</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Math</span>.<span class="ActionScriptDefault_Text">pow</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>.<span class="ActionScriptDefault_Text">localY</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">originY</span>,2<span class="ActionScriptBracket/Brace">)))</span>;
                    <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">drawCircle</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">originX</span>,<span class="ActionScriptDefault_Text">originY</span>,<span class="ActionScriptDefault_Text">radius</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">endFill</span><span class="ActionScriptBracket/Brace">()</span>;                    
                    <span class="ActionScriptReserved">break</span>;                    
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptDefault_Text">originX</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">NaN</span>; <span class="ActionScriptComment">//reset the orogin to NaN
</span>            <span class="ActionScriptDefault_Text">originY</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">NaN</span>;
            <span class="ActionScriptComment">//THE FOLLOWING IS NOT IMPLEMETED FOR A CIRCLE YET
</span>            <span class="ActionScriptComment">//convert the points to lat/longs - to allow us to query ArcGIS Server and also to redraw if the user zooms/pans
</span>            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">points</span>.<span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">==</span>0<span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">Alert</span>.<span class="ActionScriptDefault_Text">show</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;To zoom in you need to deselect the drawing tool&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">points</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">({</span><span class="ActionScriptDefault_Text">X</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">points</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>.<span class="ActionScriptDefault_Text">X</span>,<span class="ActionScriptDefault_Text">Y</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">points</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>.<span class="ActionScriptDefault_Text">Y</span><span class="ActionScriptBracket/Brace">})</span>; <span class="ActionScriptComment">// close the polygon - this is needed for creating the correct UDA geometry
</span>                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_pointsArray</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span> <span class="ActionScriptComment">//array of points in the UDA as lat/long coordinates
</span>                <span class="ActionScriptDefault_Text">lastPoints</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">[]</span>; <span class="ActionScriptComment">//reset the last points array - this array is used in the positionOverlay function
</span>                <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">point</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">points</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">//create the array of lat/longs from the points array
</span>                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_Point</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Point</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Point</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">point</span>.<span class="ActionScriptDefault_Text">X</span>,<span class="ActionScriptDefault_Text">point</span>.<span class="ActionScriptDefault_Text">Y</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_LatLng</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">LatLng</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">pane</span>.<span class="ActionScriptDefault_Text">fromPaneCoordsToLatLng</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_Point</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//convert to lat/long
</span>                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_mapPoint</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">MapPoint</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">MapPoint</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_LatLng</span>.<span class="ActionScriptDefault_Text">lng</span><span class="ActionScriptBracket/Brace">()</span>,<span class="ActionScriptDefault_Text">_LatLng</span>.<span class="ActionScriptDefault_Text">lat</span><span class="ActionScriptBracket/Brace">())</span>; <span class="ActionScriptComment">//create an ESRI point 
</span>                    <span class="ActionScriptDefault_Text">_pointsArray</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_mapPoint</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//and add it to the UDA that we will create
</span>                    <span class="ActionScriptDefault_Text">lastPoints</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_LatLng</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//add the LatLng to an array of points in case the user zooms/pans
</span>                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_ringsArray</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>; <span class="ActionScriptComment">//create a new array to hold each of the rings in the polygon
</span>                <span class="ActionScriptDefault_Text">_ringsArray</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_pointsArray</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//add the lat/long points array to the rings collection
</span>                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_geometry</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Polygon</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Polygon</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_ringsArray</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//create a new ESRI polygon geometry to query the data
</span>                <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">UDACreatedEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;UDACreated&quot;</span>,<span class="ActionScriptDefault_Text">_geometry</span><span class="ActionScriptBracket/Brace">))</span>; <span class="ActionScriptComment">//fire the UDA Created event
</span>                <span class="ActionScriptDefault_Text">points</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">[]</span>; <span class="ActionScriptComment">//reset the points array to an empty array
</span>            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptComment">//must be implemented as part of IBaseOverlay (think thats what its called)
</span>        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getDefaultPane</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">IMap</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">IPane</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">map</span>.<span class="ActionScriptDefault_Text">getPaneManager</span><span class="ActionScriptBracket/Brace">()</span>.<span class="ActionScriptDefault_Text">getPaneById</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">PaneId</span>.<span class="ActionScriptDefault_Text">PANE_OVERLAYS</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptComment">//must be implemented as part of IBaseOverlay - this is called a lot whever the user zooms or pans the map
</span>        <span class="ActionScriptReserved">override</span> <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">positionOverlay</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">arg0</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lastPoints</span>.<span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">==</span>0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span>; <span class="ActionScriptComment">//no UDA to draw
</span>            <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">clear</span><span class="ActionScriptBracket/Brace">()</span>; <span class="ActionScriptComment">//clear the existing scribble and redraw it in the right place
</span>            <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">beginFill</span><span class="ActionScriptBracket/Brace">(</span>0<span class="ActionScriptDefault_Text">x000000</span>,0.1<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">lineStyle</span><span class="ActionScriptBracket/Brace">(</span>1,0<span class="ActionScriptDefault_Text">x000000</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_point</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Point</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">pane</span>.<span class="ActionScriptDefault_Text">fromLatLngToPaneCoords</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">lastPoints</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">])</span>; <span class="ActionScriptComment">//convert the point from lat/long to a screen coordinate
</span>            <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">moveTo</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_point</span>.<span class="ActionScriptDefault_Text">x</span>,<span class="ActionScriptDefault_Text">_point</span>.<span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//move to the start
</span>            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span>1;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">lastPoints</span>.<span class="ActionScriptDefault_Text">length</span>;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">//draw the polygon
</span>            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_LatLng</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">LatLng</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">lastPoints</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">_point</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">pane</span>.<span class="ActionScriptDefault_Text">fromLatLngToPaneCoords</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_LatLng</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">lineTo</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_point</span>.<span class="ActionScriptDefault_Text">x</span>,<span class="ActionScriptDefault_Text">_point</span>.<span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span>;                        
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptDefault_Text">canvas</span>.<span class="ActionScriptDefault_Text">graphics</span>.<span class="ActionScriptDefault_Text">endFill</span><span class="ActionScriptBracket/Brace">()</span>;            
        <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptBracket/Brace">}</span></pre></body>
</html>
