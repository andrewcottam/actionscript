<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>SeaLevelRiseLayer.as</title>
<link rel="stylesheet" type="text/css" href="../../../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptComment">/*
 * ArcGIS for Google Maps Flash API
 *
 * License http://www.apache.org/licenses/LICENSE-2.0
 */</span>
 <span class="ActionScriptASDoc">/**
 * @author nianwei at gmail dot com
 */</span> 

<span class="ActionScriptpackage">package</span> <span class="ActionScriptDefault_Text">wcmc</span>.<span class="ActionScriptDefault_Text">classes</span> <span class="ActionScriptBracket/Brace">{</span>
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">google</span>.<span class="ActionScriptDefault_Text">maps</span>.<span class="ActionScriptOperator">*</span>;
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">google</span>.<span class="ActionScriptDefault_Text">maps</span>.<span class="ActionScriptDefault_Text">extras</span>.<span class="ActionScriptDefault_Text">arcgislink</span>.<span class="ActionScriptOperator">*</span>;
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span>.<span class="ActionScriptDefault_Text">google</span>.<span class="ActionScriptDefault_Text">maps</span>.<span class="ActionScriptDefault_Text">interfaces</span>.<span class="ActionScriptOperator">*</span>;
  
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">display</span>.<span class="ActionScriptDefault_Text">Bitmap</span>;
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">display</span>.<span class="ActionScriptDefault_Text">BitmapData</span>;
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">display</span>.<span class="ActionScriptDefault_Text">DisplayObject</span>;
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">display</span>.<span class="ActionScriptDefault_Text">Loader</span>;
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">display</span>.<span class="ActionScriptDefault_Text">LoaderInfo</span>;
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">events</span>.<span class="ActionScriptOperator">*</span>;
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">filters</span>.<span class="ActionScriptDefault_Text">BlurFilter</span>;
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">Point</span>;
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">geom</span>.<span class="ActionScriptDefault_Text">Rectangle</span>;
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span>.<span class="ActionScriptDefault_Text">net</span>.<span class="ActionScriptDefault_Text">URLRequest</span>;
  
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span>.<span class="ActionScriptDefault_Text">controls</span>.<span class="ActionScriptDefault_Text">HSlider</span>;
  <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span>.<span class="ActionScriptDefault_Text">events</span>.<span class="ActionScriptDefault_Text">SliderEvent</span>;
  <span class="ActionScriptASDoc">/**
   * Used for cached map service
   */</span>
  <span class="ActionScriptComment">//There some unique challenges in AS3 compare to JS in implementing this class :
</span>  <span class="ActionScriptComment">// --can not call super in a callback function, must be inside the constructor context
</span>  <span class="ActionScriptComment">//--copyright et once passed in constructor the overriden functions such as getCopyrightCollection etc does not seem to be used.
</span>  <span class="ActionScriptReserved">public</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">SeaLevelRiseLayer</span> <span class="ActionScriptReserved">extends</span> <span class="ActionScriptDefault_Text">TileLayerBase</span> <span class="ActionScriptReserved">implements</span> <span class="ActionScriptDefault_Text">IEventDispatcher</span> <span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">baseUrl_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">mapService_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">MapService</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">urlTemplate_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">numOfHosts_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span>;
    <span class="ActionScriptReserved">internal</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">projection_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">ArcGISTileConfig</span>; <span class="ActionScriptComment">// need access from MapType
</span>    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fullBounds_</span><span class="ActionScriptOperator">:*</span> <span class="ActionScriptComment">/*Envelope*/</span> ;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">initialBounds_</span><span class="ActionScriptOperator">:*</span> <span class="ActionScriptComment">/*Envelope*/</span> ;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">seaLevelRiseBitmaps</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Array</span>; <span class="ActionScriptComment">//array of sea level rise bitmap objects - these are onscreen and offscreen bitmaps and the urls
</span>    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">slider</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">HSlider</span>;
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">zoomLevel</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>; <span class="ActionScriptComment">//current zoom level
</span>    <span class="ActionScriptASDoc">/**
     *If true the full DEM will be shown alongside the areas that are highlighted
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">showDEM</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span>;
    <span class="ActionScriptASDoc">/**
     *If true, background values will not be shown as highlighted areas 
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">hideBackground</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">true</span>;
    <span class="ActionScriptASDoc">/**
     *The color of the highlighted areas 
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">highlightColor</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">uint</span>;
    
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">SeaLevelRiseLayer</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">service</span><span class="ActionScriptOperator">:*</span>, <span class="ActionScriptDefault_Text">_seaLevelRiseLayerOverlay</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SeaLevelRiseLayerOverlay</span>, <span class="ActionScriptDefault_Text">_slider</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">HSlider</span>,<span class="ActionScriptDefault_Text">opt_layerOpts</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">ArcGISTileLayerOptions</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">undefined</span><span class="ActionScriptBracket/Brace">)</span> 
    <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptDefault_Text">slider</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">_slider</span>;
      <span class="ActionScriptDefault_Text">dispatcher_</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">EventDispatcher</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptDefault_Text">opt_layerOpts</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">opt_layerOpts</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ArcGISTileLayerOptions</span><span class="ActionScriptBracket/Brace">({})</span>;
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">mapService_</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">service</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">MapService</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">service</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">MapService</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">MapService</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">service</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">opt_layerOpts</span>.<span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">)</span> 
      <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">mapService_</span>.<span class="ActionScriptDefault_Text">name</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">opt_layerOpts</span>.<span class="ActionScriptDefault_Text">name</span>;
      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">alpha_</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">opt_layerOpts</span>.<span class="ActionScriptDefault_Text">alpha</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">Alpha</span>.<span class="ActionScriptDefault_Text">OPAQUE</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptDefault_Text">opt_layerOpts</span>.<span class="ActionScriptDefault_Text">alpha</span>;

      <span class="ActionScriptComment">//In the format of mt[number].domain.com
</span>      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">opt_layerOpts</span>.<span class="ActionScriptDefault_Text">hosts</span><span class="ActionScriptBracket/Brace">)</span> 
      <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pro</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">ArcGISUtil</span>.<span class="ActionScriptDefault_Text">extractString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">mapService_</span>.<span class="ActionScriptDefault_Text">url</span>, <span class="ActionScriptString">&apos;&apos;</span>, <span class="ActionScriptString">&apos;://&apos;</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">host</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">ArcGISUtil</span>.<span class="ActionScriptDefault_Text">extractString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">mapService_</span>.<span class="ActionScriptDefault_Text">url</span>, <span class="ActionScriptString">&apos;://&apos;</span>, <span class="ActionScriptString">&apos;/&apos;</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">path</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">ArcGISUtil</span>.<span class="ActionScriptDefault_Text">extractString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">mapService_</span>.<span class="ActionScriptDefault_Text">url</span>, <span class="ActionScriptDefault_Text">pro</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">&apos;://&apos;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">host</span>, <span class="ActionScriptString">&apos;&apos;</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">urlTemplate_</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">pro</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">&apos;://&apos;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">opt_layerOpts</span>.<span class="ActionScriptDefault_Text">hosts</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">path</span>;
        <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">numOfHosts_</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">parseInt</span><span class="ActionScriptBracket/Brace">(A</span><span class="ActionScriptDefault_Text">rcGISUtil</span>.<span class="ActionScriptDefault_Text">extractString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">opt_layerOpts</span>.<span class="ActionScriptDefault_Text">hosts</span>, <span class="ActionScriptString">&apos;[&apos;</span>, <span class="ActionScriptString">&apos;]&apos;</span><span class="ActionScriptBracket/Brace">)</span>, 10<span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">copy</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">ICopyrightCollection</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">opt_layerOpts</span>.<span class="ActionScriptDefault_Text">copyrights</span>;
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">copy</span><span class="ActionScriptBracket/Brace">)</span> 
      <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">copy</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">CopyrightCollection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&apos;pre&apos;</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">copy</span>.<span class="ActionScriptDefault_Text">addCopyright</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Copyright</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&apos;1&apos;</span>, <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">LatLngBounds</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">LatLng</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">-</span>90, <span class="ActionScriptOperator">-</span>180<span class="ActionScriptBracket/Brace">)</span>, <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">LatLng</span><span class="ActionScriptBracket/Brace">(</span>90, 180<span class="ActionScriptBracket/Brace">))</span>, 0, <span class="ActionScriptString">&apos;&apos;</span><span class="ActionScriptBracket/Brace">))</span>;
      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">copy_</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">copy</span>;
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">minZoom_</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">opt_layerOpts</span>.<span class="ActionScriptDefault_Text">minResolution</span> <span class="ActionScriptOperator">||</span> 0;
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">maxZoom_</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">opt_layerOpts</span>.<span class="ActionScriptDefault_Text">maxResolution</span> <span class="ActionScriptOperator">||</span> 20;

      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">mapService_</span>.<span class="ActionScriptDefault_Text">hasLoaded</span><span class="ActionScriptBracket/Brace">())</span> 
      <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">init_</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">opt_layerOpts</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptBracket/Brace">}</span> 
      <span class="ActionScriptReserved">else</span> 
      <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">me</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SeaLevelRiseLayer</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">this</span>;
        <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">mapService_</span>.<span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ServiceEvent</span>.<span class="ActionScriptDefault_Text">LOAD</span>, <span class="ActionScriptfunction">function</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">me</span>.<span class="ActionScriptDefault_Text">init_</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">opt_layerOpts</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">me</span>.<span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ServiceEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ServiceEvent</span>.<span class="ActionScriptDefault_Text">LOAD</span><span class="ActionScriptBracket/Brace">))</span>;
          <span class="ActionScriptBracket/Brace">})</span>;
      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptReserved">super</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">copy_</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">minZoom_</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">maxZoom_</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">alpha_</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">mapService_</span>.<span class="ActionScriptDefault_Text">hasLoaded</span><span class="ActionScriptBracket/Brace">())</span> 
      <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ServiceEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ServiceEvent</span>.<span class="ActionScriptDefault_Text">LOAD</span><span class="ActionScriptBracket/Brace">))</span>;
      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptDefault_Text">seaLevelRiseBitmaps</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">()</span>; <span class="ActionScriptComment">//instantiate a new array to hold references to all of the loader objects
</span>      <span class="ActionScriptDefault_Text">_slider</span>.<span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">SliderEvent</span>.<span class="ActionScriptDefault_Text">CHANGE</span>,<span class="ActionScriptDefault_Text">applyThreshold</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//wire the change event of the slider to the applyThreshold method
</span>    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
     * Initialize the tile layer from a loaded map service
     * @param {ArcGISMapService} mapService
     * @param {Object} opt_layerOpts
     */</span>
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">init_</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">opt_layerOpts</span><span class="ActionScriptOperator">:*</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">projection_</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ArcGISTileConfig</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">mapService_</span>.<span class="ActionScriptDefault_Text">tileInfo</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">mapService_</span>.<span class="ActionScriptDefault_Text">fullExtent</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">copy</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">CopyrightCollection</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">opt_layerOpts</span>.<span class="ActionScriptDefault_Text">copyrights</span>;
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">copy</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">copy</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">CopyrightCollection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&apos;&apos;</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">copy</span>.<span class="ActionScriptDefault_Text">addCopyright</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Copyright</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&apos;1&apos;</span>, <span class="ActionScriptDefault_Text">ArcGISUtil</span>.<span class="ActionScriptDefault_Text">fromEnvelopeToLatLngBounds</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">mapService_</span>.<span class="ActionScriptDefault_Text">fullExtent</span><span class="ActionScriptBracket/Brace">)</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">projection_</span>.<span class="ActionScriptDefault_Text">zoomOffset_</span>, <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">mapService_</span>.<span class="ActionScriptDefault_Text">copyrightText</span><span class="ActionScriptBracket/Brace">))</span>;
      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">copy_</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">copy</span>;
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">minZoom_</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">opt_layerOpts</span>.<span class="ActionScriptDefault_Text">minResolution</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">projection_</span>.<span class="ActionScriptDefault_Text">minResolution</span><span class="ActionScriptBracket/Brace">()</span>;
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">maxZoom_</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">opt_layerOpts</span>.<span class="ActionScriptDefault_Text">maxResolution</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">projection_</span>.<span class="ActionScriptDefault_Text">maxResolution</span><span class="ActionScriptBracket/Brace">()</span>;
      <span class="ActionScriptComment">// It seems unlike in JS, AS3&apos;s super can be called only in one place in constructor, 
</span>      <span class="ActionScriptComment">// as a workaround all get methods are overriden.
</span>      <span class="ActionScriptComment">// TileLayerBase.call(this, copy, minZoom, maxZoom, opt_layerOpts);
</span>      <span class="ActionScriptComment">// super(copy, minZoom, maxZoom, opt_layerOpts.alpha);
</span>    <span class="ActionScriptBracket/Brace">}</span>
    
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">ioErrorHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">IOErrorEvent</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScripttrace">trace</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;ioErrorHandler: &quot;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
     * Gain access to the underline {@link ArcGISMapService}
     * @return {MapSerive}
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getMapService</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">MapService</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">mapService_</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
     * Get full bounds of the to the underline {@link ArcGISMapService}
     * @return {GLatLngBounds}
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getFullBounds</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">LatLngBounds</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">fullBounds_</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">fullBounds_</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">ArcGISUtil</span>.<span class="ActionScriptDefault_Text">fromEnvelopeToLatLngBounds</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">mapService_</span>.<span class="ActionScriptDefault_Text">fullExtent</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">fullBounds_</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getInitialBounds</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">LatLngBounds</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">initialBounds_</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">initialBounds_</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">ArcGISUtil</span>.<span class="ActionScriptDefault_Text">fromEnvelopeToLatLngBounds</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">mapService_</span>.<span class="ActionScriptDefault_Text">initialExtent</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">initialBounds_</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptASDoc">/**
     * Returns the {@link ArcGISProjection}, a subclass of &lt;code&gt;GProjection&lt;/code&gt;
     *  used by this ArcGISTileLayer.
     * @return {ArcGISProjection}
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getProjection</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">ArcGISTileConfig</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">projection_</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptDefault_Text">ArcGISTileConfig</span>.<span class="ActionScriptDefault_Text">GOOGLE_MAPS</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">hasLoaded</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">mapService_</span>.<span class="ActionScriptDefault_Text">hasLoaded</span><span class="ActionScriptBracket/Brace">()</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getName</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">mapService_</span>.<span class="ActionScriptDefault_Text">name</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dispatcher_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">EventDispatcher</span>;

    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>, <span class="ActionScriptDefault_Text">listener</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Function</span>, <span class="ActionScriptDefault_Text">useCapture</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">false</span>, <span class="ActionScriptDefault_Text">priority</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0, <span class="ActionScriptDefault_Text">useWeakReference</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>

      <span class="ActionScriptDefault_Text">dispatcher_</span>.<span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">type</span>, <span class="ActionScriptDefault_Text">listener</span>, <span class="ActionScriptDefault_Text">useCapture</span>, <span class="ActionScriptDefault_Text">priority</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">evt</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">dispatcher_</span>.<span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">evt</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">hasEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">dispatcher_</span>.<span class="ActionScriptDefault_Text">hasEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">type</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>, <span class="ActionScriptDefault_Text">listener</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Function</span>, <span class="ActionScriptDefault_Text">useCapture</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptDefault_Text">dispatcher_</span>.<span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">type</span>, <span class="ActionScriptDefault_Text">listener</span>, <span class="ActionScriptDefault_Text">useCapture</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">willTrigger</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">type</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">dispatcher_</span>.<span class="ActionScriptDefault_Text">willTrigger</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">type</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>


    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">copy_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">ICopyrightCollection</span>;

    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">override</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getCopyrightCollection</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">ICopyrightCollection</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">copy_</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">copy_</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptReserved">super</span>.<span class="ActionScriptDefault_Text">getCopyrightCollection</span><span class="ActionScriptBracket/Brace">()</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">maxZoom_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;

    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">override</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getMaxResolution</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">maxZoom_</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">maxZoom_</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptReserved">super</span>.<span class="ActionScriptDefault_Text">getMaxResolution</span><span class="ActionScriptBracket/Brace">()</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">minZoom_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;

    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">override</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getMinResolution</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">minZoom_</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">minZoom_</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptReserved">super</span>.<span class="ActionScriptDefault_Text">getMinResolution</span><span class="ActionScriptBracket/Brace">()</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">alpha_</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;

    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">override</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getAlpha</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">alpha_</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">alpha_</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptReserved">super</span>.<span class="ActionScriptDefault_Text">getAlpha</span><span class="ActionScriptBracket/Brace">()</span>;
    <span class="ActionScriptBracket/Brace">}</span>

    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setAlpha</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">alpha</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">alpha_</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">alpha</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptASDoc">/**
     * Creates and loads a tile (x, y) at the given zoom level.
     * @param tilePos  Tile coordinates.
     * @param zoom  Tile zoom.
     * @return  Display object representing the tile.
     */</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">override</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">loadTile</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tile</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Point</span>, <span class="ActionScriptDefault_Text">zoom</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">DisplayObject</span> 
    <span class="ActionScriptBracket/Brace">{</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">url</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span>; <span class="ActionScriptComment">//.minResolution()
</span>      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">z</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">zoom</span> <span class="ActionScriptOperator">-</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">projection_</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">projection_</span>.<span class="ActionScriptDefault_Text">zoomOffset_</span> <span class="ActionScriptOperator">:</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">getMinResolution</span><span class="ActionScriptBracket/Brace">())</span>; <span class="ActionScriptComment">//.minResolution());
</span>      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">zoomLevel</span><span class="ActionScriptBracket/Brace">))</span> <span class="ActionScriptDefault_Text">zoomLevel</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">z</span>;
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tile</span>.<span class="ActionScriptDefault_Text">x</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">isNaN</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tile</span>.<span class="ActionScriptDefault_Text">y</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">&gt;=</span> 0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">u</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">mapService_</span>.<span class="ActionScriptDefault_Text">url</span>;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">urlTemplate_</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
          <span class="ActionScriptDefault_Text">u</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">urlTemplate_</span>.<span class="ActionScriptDefault_Text">replace</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&apos;[&apos;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">numOfHosts_</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">&apos;]&apos;</span>, <span class="ActionScriptString">&apos;&apos;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">((</span><span class="ActionScriptDefault_Text">tile</span>.<span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tile</span>.<span class="ActionScriptDefault_Text">x</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">%</span> <span class="ActionScriptReserved">this</span>.<span class="ActionScriptDefault_Text">numOfHosts_</span><span class="ActionScriptBracket/Brace">))</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptDefault_Text">url</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">u</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">&apos;/tile/&apos;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">&apos;/&apos;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tile</span>.<span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">&apos;/&apos;</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">tile</span>.<span class="ActionScriptDefault_Text">x</span>;
      <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptComment">//check that the new tiles being requested are from the same zoom level as the tiles that are already loaded. If not the user has changed zoom and we need to clear existing tiles.
</span>        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">z</span><span class="ActionScriptOperator">!=</span><span class="ActionScriptDefault_Text">zoomLevel</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScripttrace">trace</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">&quot;changedzoom&quot;</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">seaLevelRiseBitmaps</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">[]</span>;
        <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">loader</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Loader</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Loader</span><span class="ActionScriptBracket/Brace">()</span>;
      <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">url</span><span class="ActionScriptOperator">!=</span><span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>
      <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptDefault_Text">loader</span>.<span class="ActionScriptDefault_Text">contentLoaderInfo</span>.<span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">IOErrorEvent</span>.<span class="ActionScriptDefault_Text">IO_ERROR</span>, <span class="ActionScriptDefault_Text">ioErrorHandler</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">loader</span>.<span class="ActionScriptDefault_Text">contentLoaderInfo</span>.<span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Event</span>.<span class="ActionScriptDefault_Text">COMPLETE</span>,<span class="ActionScriptDefault_Text">loadTileComplete</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">loader</span>.<span class="ActionScriptDefault_Text">load</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">URLRequest</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">url</span><span class="ActionScriptBracket/Brace">))</span>;
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">seaLevelRiseBitmap</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SeaLevelRiseBitmap</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SeaLevelRiseBitmap</span><span class="ActionScriptBracket/Brace">()</span>;
        <span class="ActionScriptDefault_Text">seaLevelRiseBitmap</span>.<span class="ActionScriptDefault_Text">url</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">url</span>;
        <span class="ActionScriptDefault_Text">seaLevelRiseBitmaps</span>.<span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">seaLevelRiseBitmap</span><span class="ActionScriptBracket/Brace">)</span>;
      <span class="ActionScriptBracket/Brace">}</span>
      <span class="ActionScriptDefault_Text">zoomLevel</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">z</span>;
      <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">loader</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">loadTileComplete</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_loaderInfo</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">LoaderInfo</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">event</span>.<span class="ActionScriptDefault_Text">target</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">LoaderInfo</span>;
        <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_seaLevelRiseBitmap</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SeaLevelRiseBitmap</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">seaLevelRiseBitmaps</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_seaLevelRiseBitmap</span>.<span class="ActionScriptDefault_Text">url</span><span class="ActionScriptOperator">==</span><span class="ActionScriptDefault_Text">_loaderInfo</span>.<span class="ActionScriptDefault_Text">url</span><span class="ActionScriptBracket/Brace">)</span>  <span class="ActionScriptComment">//image data returned from ArcGIS Server - now process it
</span>            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_seaLevelRiseBitmap</span>.<span class="ActionScriptDefault_Text">onScreenBitmapData</span><span class="ActionScriptOperator">=</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_loaderInfo</span>.<span class="ActionScriptDefault_Text">content</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">Bitmap</span><span class="ActionScriptBracket/Brace">)</span>.<span class="ActionScriptDefault_Text">bitmapData</span>; <span class="ActionScriptComment">//get a pointer to the onscreen bitmap data
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">hideBackground</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">_seaLevelRiseBitmap</span>.<span class="ActionScriptDefault_Text">onScreenBitmapData</span>.<span class="ActionScriptDefault_Text">threshold</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_seaLevelRiseBitmap</span>.<span class="ActionScriptDefault_Text">onScreenBitmapData</span>,<span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Rectangle</span><span class="ActionScriptBracket/Brace">(</span>0, 0, 256,256<span class="ActionScriptBracket/Brace">)</span>, <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Point</span><span class="ActionScriptBracket/Brace">(</span>0, 0<span class="ActionScriptBracket/Brace">)</span>,<span class="ActionScriptString">&quot;==&quot;</span>,0<span class="ActionScriptDefault_Text">x00000000</span>,0<span class="ActionScriptDefault_Text">xffffffff</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//make the background values transparent if specified
</span>                <span class="ActionScriptDefault_Text">_seaLevelRiseBitmap</span>.<span class="ActionScriptDefault_Text">offScreenBitmapData</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">_seaLevelRiseBitmap</span>.<span class="ActionScriptDefault_Text">onScreenBitmapData</span>.<span class="ActionScriptDefault_Text">clone</span><span class="ActionScriptBracket/Brace">()</span>; <span class="ActionScriptComment">//copy the onscreen bitmapdata to an offscreen cache
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">showDEM</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptDefault_Text">_seaLevelRiseBitmap</span>.<span class="ActionScriptDefault_Text">onScreenBitmapData</span>.<span class="ActionScriptDefault_Text">fillRect</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Rectangle</span><span class="ActionScriptBracket/Brace">(</span>0, 0, 256,256<span class="ActionScriptBracket/Brace">)</span>,0<span class="ActionScriptDefault_Text">x00ffffff</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//clear the onscreen bitmapdata if we dont want to show the DEM
</span>                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">slider</span>.<span class="ActionScriptDefault_Text">value</span><span class="ActionScriptOperator">&gt;</span><span class="ActionScriptDefault_Text">slider</span>.<span class="ActionScriptDefault_Text">minimum</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptComment">//if the slider is not at the minimum then apply the threshold
</span>                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_threshold</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">uint</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">getThreshold</span><span class="ActionScriptBracket/Brace">()</span>;
                    <span class="ActionScriptDefault_Text">threshold</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_threshold</span>,<span class="ActionScriptDefault_Text">_seaLevelRiseBitmap</span>.<span class="ActionScriptDefault_Text">offScreenBitmapData</span>,<span class="ActionScriptDefault_Text">_seaLevelRiseBitmap</span>.<span class="ActionScriptDefault_Text">onScreenBitmapData</span><span class="ActionScriptBracket/Brace">)</span>;            
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">break</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptDefault_Text">_loaderInfo</span>.<span class="ActionScriptDefault_Text">loader</span>.<span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">IOErrorEvent</span>.<span class="ActionScriptDefault_Text">IO_ERROR</span>, <span class="ActionScriptDefault_Text">ioErrorHandler</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">_loaderInfo</span>.<span class="ActionScriptDefault_Text">loader</span>.<span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Event</span>.<span class="ActionScriptDefault_Text">COMPLETE</span>,<span class="ActionScriptDefault_Text">loadTileComplete</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">applyThreshold</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SliderEvent</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_threshold</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">uint</span><span class="ActionScriptOperator">=</span><span class="ActionScriptDefault_Text">getThreshold</span><span class="ActionScriptBracket/Brace">()</span>;
        <span class="ActionScriptReserved">for</span> <span class="ActionScriptReserved">each</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_seaLevelRiseBitmap</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">SeaLevelRiseBitmap</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">seaLevelRiseBitmaps</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">threshold</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_threshold</span>,<span class="ActionScriptDefault_Text">_seaLevelRiseBitmap</span>.<span class="ActionScriptDefault_Text">offScreenBitmapData</span>,<span class="ActionScriptDefault_Text">_seaLevelRiseBitmap</span>.<span class="ActionScriptDefault_Text">onScreenBitmapData</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">threshold</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_threshold</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">uint</span>,<span class="ActionScriptDefault_Text">offScreenBitmap</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">BitmapData</span>,<span class="ActionScriptDefault_Text">onScreenBitmap</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">BitmapData</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">onScreenBitmap</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptReserved">return</span>; 
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">copySource</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Boolean</span>;
        <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(!</span><span class="ActionScriptDefault_Text">showDEM</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">onScreenBitmap</span>.<span class="ActionScriptDefault_Text">fillRect</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Rectangle</span><span class="ActionScriptBracket/Brace">(</span>0, 0, 256,256<span class="ActionScriptBracket/Brace">)</span>,0<span class="ActionScriptDefault_Text">x00ffffff</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptDefault_Text">onScreenBitmap</span>.<span class="ActionScriptDefault_Text">threshold</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">offScreenBitmap</span>,<span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Rectangle</span><span class="ActionScriptBracket/Brace">(</span>0, 0, 256,256<span class="ActionScriptBracket/Brace">)</span>, <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Point</span><span class="ActionScriptBracket/Brace">(</span>0, 0<span class="ActionScriptBracket/Brace">)</span>,<span class="ActionScriptString">&quot;&lt;&quot;</span>,<span class="ActionScriptDefault_Text">_threshold</span>,<span class="ActionScriptDefault_Text">highlightColor</span>,0<span class="ActionScriptDefault_Text">x000000ff</span>,<span class="ActionScriptDefault_Text">showDEM</span><span class="ActionScriptBracket/Brace">)</span>; <span class="ActionScriptComment">//if we want to see the DEM then the copysource parameter is true
</span>        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_filter</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">BlurFilter</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">BlurFilter</span><span class="ActionScriptBracket/Brace">(</span>1,1<span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptDefault_Text">onScreenBitmap</span>.<span class="ActionScriptDefault_Text">applyFilter</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">onScreenBitmap</span>,<span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Rectangle</span><span class="ActionScriptBracket/Brace">(</span>0, 0, 256,256<span class="ActionScriptBracket/Brace">)</span>,<span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Point</span><span class="ActionScriptBracket/Brace">(</span>0, 0<span class="ActionScriptBracket/Brace">)</span>,<span class="ActionScriptDefault_Text">_filter</span><span class="ActionScriptBracket/Brace">)</span>;
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getThreshold</span><span class="ActionScriptBracket/Brace">()</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">uint</span>
    <span class="ActionScriptBracket/Brace">{</span>
         <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">int</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">slider</span>.<span class="ActionScriptDefault_Text">value</span><span class="ActionScriptBracket/Brace">)</span>;              
    <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">outputPixelValues</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_bitmapData</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">BitmapData</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">:</span><span class="ActionScriptReserved">void</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">col</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">Number</span>;
        <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">col</span><span class="ActionScriptOperator">=</span>125; <span class="ActionScriptDefault_Text">col</span><span class="ActionScriptOperator">&lt;</span>135; <span class="ActionScriptDefault_Text">col</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pixelValue</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_bitmapData</span>.<span class="ActionScriptDefault_Text">getPixel32</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">col</span>, 100<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">alphaValue</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">pixelValue</span> <span class="ActionScriptOperator">&gt;&gt;</span> 24 <span class="ActionScriptOperator">&amp;</span> 0<span class="ActionScriptDefault_Text">xFF</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">red</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">pixelValue</span> <span class="ActionScriptOperator">&gt;&gt;</span> 16 <span class="ActionScriptOperator">&amp;</span> 0<span class="ActionScriptDefault_Text">xFF</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">green</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">pixelValue</span> <span class="ActionScriptOperator">&gt;&gt;</span> 8 <span class="ActionScriptOperator">&amp;</span> 0<span class="ActionScriptDefault_Text">xFF</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">blue</span><span class="ActionScriptOperator">:</span><span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">pixelValue</span> <span class="ActionScriptOperator">&amp;</span> 0<span class="ActionScriptDefault_Text">xFF</span>;
<span class="ActionScriptComment">//            trace(&quot;Alpha:&quot; + alphaValue.toString(16) + &quot; Red:&quot; + red.toString(16) + &quot; Green:&quot; + green.toString(16) + &quot; Blue:&quot; + blue.toString(16)); // ff
</span>        <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptBracket/Brace">}</span>
  <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptBracket/Brace">}</span></pre></body>
</html>
